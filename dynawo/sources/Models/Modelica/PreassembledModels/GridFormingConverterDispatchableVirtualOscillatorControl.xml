<?xml version='1.0' encoding='UTF-8'?>
<!--
    Copyright (c) 2015-2019, RTE (http://www.rte-france.com)
    See AUTHORS.txt
    All rights reserved.
    This Source Code Form is subject to the terms of the Mozilla Public
    License, v. 2.0. If a copy of the MPL was not distributed with this
    file, you can obtain one at http://mozilla.org/MPL/2.0/.
    SPDX-License-Identifier: MPL-2.0

    This file is part of Dynawo, an hybrid C++/Modelica open source time domain
    simulation tool for power systems.
-->
<dyn:dynamicModelsArchitecture xmlns:dyn="http://www.rte-france.com/dynawo">
  <dyn:modelicaModel id="GridFormingConverterDispatchableVirtualOscillatorControl">
    <dyn:unitDynamicModel id="converter" name="Dynawo.Electrical.Sources.Converter" initName="Dynawo.Electrical.Sources.Converter_INIT"/>
    <dyn:unitDynamicModel id="control" name="Dynawo.Electrical.Controls.Converters.GlobalDispatchableVirtualOscillatorControl" initName="Dynawo.Electrical.Controls.Converters.GlobalDispatchableVirtualOscillatorControl_INIT"/>
    <dyn:unitDynamicModel id="SetPref" name="Dynawo.Electrical.Controls.Basics.SetPoint" initName="Dynawo.Electrical.Controls.Basics.SetPoint_INIT"/>
    <dyn:unitDynamicModel id="SetQref" name="Dynawo.Electrical.Controls.Basics.SetPoint" initName="Dynawo.Electrical.Controls.Basics.SetPoint_INIT"/>
    <dyn:unitDynamicModel id="SetVeffref" name="Dynawo.Electrical.Controls.Basics.SetPoint" initName="Dynawo.Electrical.Controls.Basics.SetPoint_INIT"/>
    <dyn:unitDynamicModel id="Setwref" name="Dynawo.Electrical.Controls.Basics.SetPoint" initName="Dynawo.Electrical.Controls.Basics.SetPoint_INIT"/>
    <dyn:unitDynamicModel id="Setidcref" name="Dynawo.Electrical.Controls.Basics.SetPoint" initName="Dynawo.Electrical.Controls.Basics.SetPoint_INIT"/>
    <dyn:unitDynamicModel id="Setvdcref" name="Dynawo.Electrical.Controls.Basics.SetPoint" initName="Dynawo.Electrical.Controls.Basics.SetPoint_INIT"/>
    <dyn:connect id1="control" var1="pref" id2="SetPref" var2="setPoint.value"/>
    <dyn:connect id1="control" var1="qref" id2="SetQref" var2="setPoint.value"/>
    <dyn:connect id1="control" var1="Veffref" id2="SetVeffref" var2="setPoint.value"/>
    <dyn:connect id1="control" var1="wref" id2="Setwref" var2="setPoint.value"/>
    <dyn:connect id1="control" var1="idcref" id2="Setidcref" var2="setPoint.value"/>
    <dyn:connect id1="converter" var1="vdcref" id2="Setvdcref" var2="setPoint"/>
    <dyn:initConnect id1="control" var1="Pref0" id2="SetPref" var2="Value0"/>
    <dyn:initConnect id1="control" var1="Qref0" id2="SetQref" var2="Value0"/>
    <dyn:initConnect id1="control" var1="VFilterd0" id2="SetVeffref" var2="Value0"/>
    <dyn:initConnect id1="control" var1="Wref0" id2="Setwref" var2="Value0"/>
    <dyn:initConnect id1="control" var1="Idcref0" id2="Setidcref" var2="Value0"/>
    <dyn:initConnect id1="converter" var1="VFilterd0" id2="Setvdcref" var2="Value0"/>
    <dyn:initConnect id1="converter" var1="VConvdref0" id2="control" var2="VConvdref0"/>
    <dyn:initConnect id1="converter" var1="VConvqref0" id2="control" var2="VConvqref0"/>
    <dyn:initConnect id1="converter" var1="Idc0" id2="control" var2="Idc0"/>
    <dyn:initConnect id1="converter" var1="Vdc0" id2="control" var2="Vdc0"/>
    <dyn:initConnect id1="converter" var1="Theta0" id2="control" var2="Theta0"/>
    <dyn:initConnect id1="control" var1="IPCCd0" id2="converter" var2="IPCCd0"/>
    <dyn:initConnect id1="control" var1="IPCCq0" id2="converter" var2="IPCCq0"/>
    <dyn:initConnect id1="control" var1="VFilterd0" id2="converter" var2="VFilterd0"/>
    <dyn:initConnect id1="control" var1="VFilterq0" id2="converter" var2="VFilterq0"/>
    <dyn:initConnect id1="control" var1="IConvd0" id2="converter" var2="IConvd0"/>
    <dyn:initConnect id1="control" var1="IConvq0" id2="converter" var2="IConvq0"/>
    <dyn:connect id1="converter" var1="vConvdref" id2="control" var2="vConvdrefPin"/>
    <dyn:connect id1="converter" var1="vConvqref" id2="control" var2="vConvqrefPin"/>
    <dyn:connect id1="converter" var1="idc" id2="control" var2="idcPin"/>
    <dyn:connect id1="Setvdcref" var1="setPoint.value" id2="control" var2="vdcref"/>
    <dyn:connect id1="converter" var1="vdc" id2="control" var2="vdc"/>
    <dyn:connect id1="converter" var1="omegaPu" id2="control" var2="omegaPuPin"/>
    <dyn:connect id1="converter" var1="theta" id2="control" var2="thetaPin"/>
    <dyn:connect id1="control" var1="iPCCd" id2="converter" var2="iPCCd"/>
    <dyn:connect id1="control" var1="iPCCq" id2="converter" var2="iPCCq"/>
    <dyn:connect id1="control" var1="vFilterd" id2="converter" var2="vFilterd"/>
    <dyn:connect id1="control" var1="vFilterq" id2="converter" var2="vFilterq"/>
    <dyn:connect id1="control" var1="iConvd" id2="converter" var2="iConvd"/>
    <dyn:connect id1="control" var1="iConvq" id2="converter" var2="iConvq"/>
  </dyn:modelicaModel>
</dyn:dynamicModelsArchitecture>