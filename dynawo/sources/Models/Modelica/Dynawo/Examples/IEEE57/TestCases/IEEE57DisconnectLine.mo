within Dynawo.Examples.IEEE57.TestCases;

/*
* Copyright (c) 2024, RTE (http://www.rte-france.com)
* See AUTHORS.txt
* All rights reserved.
* This Source Code Form is subject to the terms of the Mozilla Public
* License, v. 2.0. If a copy of the MPL was not distributed with this
* file, you can obtain one at http://mozilla.org/MPL/2.0/.
* SPDX-License-Identifier: MPL-2.0
*
* This file is part of Dynawo, an hybrid C++/Modelica open source suite
* of simulation tools for power systems.
*/

model IEEE57DisconnectLine "IEEE 57-bus system benchmark formed with 57 buses, 7 generators, 3 shunts, 16 transformers, 63 lines and 42 loads, with a line disconnection"
  extends Dynawo.Examples.IEEE57.BaseClasses.IEEE57Base;
  extends Modelica.Icons.Example;

equation
  // Loads references
  Load1.PRefPu = 0.55;
  Load1.QRefPu = 0.17;
  Load2.PRefPu = 0.03;
  Load2.QRefPu = 0.88;
  Load3.PRefPu = 0.41;
  Load3.QRefPu = 0.21;
  Load5.PRefPu = 0.13;
  Load5.QRefPu = 0.04;
  Load6.PRefPu = 0.75;
  Load6.QRefPu = 0.02;
  Load8.PRefPu = 1.5;
  Load8.QRefPu = 0.22;
  Load9.PRefPu = 1.21;
  Load9.QRefPu = 0.26;
  Load10.PRefPu = 0.05;
  Load10.QRefPu = 0.02;
  Load12.PRefPu = 3.77;
  Load12.QRefPu = 0.24;
  Load13.PRefPu = 0.18;
  Load13.QRefPu = 0.023;
  Load14.PRefPu = 0.105;
  Load14.QRefPu = 0.053;
  Load15.PRefPu = 0.22;
  Load15.QRefPu = 0.05;
  Load16.PRefPu = 0.43;
  Load16.QRefPu = 0.03;
  Load17.PRefPu = 0.42;
  Load17.QRefPu = 0.08;
  Load18.PRefPu = 0.272;
  Load18.QRefPu = 0.098;
  Load19.PRefPu = 0.033;
  Load19.QRefPu = 0.006;
  Load20.PRefPu = 0.023;
  Load20.QRefPu = 0.01;
  Load23.PRefPu = 0.063;
  Load23.QRefPu = 0.021;
  Load25.PRefPu = 0.063;
  Load25.QRefPu = 0.032;
  Load27.PRefPu = 0.093;
  Load27.QRefPu = 0.005;
  Load28.PRefPu = 0.046;
  Load28.QRefPu = 0.023;
  Load29.PRefPu = 0.17;
  Load29.QRefPu = 0.026;
  Load30.PRefPu = 0.036;
  Load30.QRefPu = 0.018;
  Load31.PRefPu = 0.058;
  Load31.QRefPu = 0.029;
  Load32.PRefPu = 0.016;
  Load32.QRefPu = 0.008;
  Load33.PRefPu = 0.038;
  Load33.QRefPu = 0.019;
  Load35.PRefPu = 0.06;
  Load35.QRefPu = 0.03;
  Load38.PRefPu = 0.14;
  Load38.QRefPu = 0.07;
  Load41.PRefPu = 0.063;
  Load41.QRefPu = 0.03;
  Load42.PRefPu = 0.071;
  Load42.QRefPu = 0.044;
  Load43.PRefPu = 0.02;
  Load43.QRefPu = 0.01;
  Load44.PRefPu = 0.12;
  Load44.QRefPu = 0.018;
  Load47.PRefPu = 0.297;
  Load47.QRefPu = 0.116;
  Load49.PRefPu = 0.18;
  Load49.QRefPu = 0.085;
  Load50.PRefPu = 0.21;
  Load50.QRefPu = 0.105;
  Load51.PRefPu = 0.18;
  Load51.QRefPu = 0.053;
  Load52.PRefPu = 0.049;
  Load52.QRefPu = 0.022;
  Load53.PRefPu = 0.2;
  Load53.QRefPu = 0.1;
  Load54.PRefPu = 0.041;
  Load54.QRefPu = 0.014;
  Load55.PRefPu = 0.068;
  Load55.QRefPu = 0.034;
  Load56.PRefPu = 0.076;
  Load56.QRefPu = 0.022;
  Load57.PRefPu = 0.067;
  Load57.QRefPu = 0.02;

  Load1.deltaP = 0;
  Load1.deltaQ = 0;
  Load2.deltaP = 0;
  Load2.deltaQ = 0;
  Load3.deltaP = 0;
  Load3.deltaQ = 0;
  Load5.deltaP = 0;
  Load5.deltaQ = 0;
  Load6.deltaP = 0;
  Load6.deltaQ = 0;
  Load8.deltaP = 0;
  Load8.deltaQ = 0;
  Load9.deltaP = 0;
  Load9.deltaQ = 0;
  Load10.deltaP = 0;
  Load10.deltaQ = 0;
  Load12.deltaP = 0;
  Load12.deltaQ = 0;
  Load13.deltaP = 0;
  Load13.deltaQ = 0;
  Load14.deltaP = 0;
  Load14.deltaQ = 0;
  Load15.deltaP = 0;
  Load15.deltaQ = 0;
  Load16.deltaP = 0;
  Load16.deltaQ = 0;
  Load17.deltaP = 0;
  Load17.deltaQ = 0;
  Load18.deltaP = 0;
  Load18.deltaQ = 0;
  Load19.deltaP = 0;
  Load19.deltaQ = 0;
  Load20.deltaP = 0;
  Load20.deltaQ = 0;
  Load23.deltaP = 0;
  Load23.deltaQ = 0;
  Load25.deltaP = 0;
  Load25.deltaQ = 0;
  Load27.deltaP = 0;
  Load27.deltaQ = 0;
  Load28.deltaP = 0;
  Load28.deltaQ = 0;
  Load29.deltaP = 0;
  Load29.deltaQ = 0;
  Load30.deltaP = 0;
  Load30.deltaQ = 0;
  Load31.deltaP = 0;
  Load31.deltaQ = 0;
  Load32.deltaP = 0;
  Load32.deltaQ = 0;
  Load33.deltaP = 0;
  Load33.deltaQ = 0;
  Load35.deltaP = 0;
  Load35.deltaQ = 0;
  Load38.deltaP = 0;
  Load38.deltaQ = 0;
  Load41.deltaP = 0;
  Load41.deltaQ = 0;
  Load42.deltaP = 0;
  Load42.deltaQ = 0;
  Load43.deltaP = 0;
  Load43.deltaQ = 0;
  Load44.deltaP = 0;
  Load44.deltaQ = 0;
  Load47.deltaP = 0;
  Load47.deltaQ = 0;
  Load49.deltaP = 0;
  Load49.deltaQ = 0;
  Load50.deltaP = 0;
  Load50.deltaQ = 0;
  Load51.deltaP = 0;
  Load51.deltaQ = 0;
  Load52.deltaP = 0;
  Load52.deltaQ = 0;
  Load53.deltaP = 0;
  Load53.deltaQ = 0;
  Load54.deltaP = 0;
  Load54.deltaQ = 0;
  Load55.deltaP = 0;
  Load55.deltaQ = 0;
  Load56.deltaP = 0;
  Load56.deltaQ = 0;
  Load57.deltaP = 0;
  Load57.deltaQ = 0;

  // Generators references
  Gen1.URefPu = Gen1.URef0Pu;
  Gen1.PRefPu = Gen1.PRef0Pu;
  Gen2.URefPu = Gen2.URef0Pu;
  Gen2.PRefPu = Gen2.PRef0Pu;
  Gen3.URefPu = Gen3.URef0Pu;
  Gen3.PRefPu = Gen3.PRef0Pu;
  Gen6.URefPu = Gen6.URef0Pu;
  Gen6.PRefPu = Gen6.PRef0Pu;
  Gen8.URefPu = Gen8.URef0Pu;
  Gen8.PRefPu = Gen8.PRef0Pu;
  Gen9.URefPu = Gen9.URef0Pu;
  Gen9.PRefPu = Gen9.PRef0Pu;
  Gen12.URefPu = Gen12.URef0Pu;
  Gen12.PRefPu = Gen12.PRef0Pu;

  // Switch off signals for loads, generators, lines, transformers and shunts
  Load1.switchOffSignal1.value = false;
  Load1.switchOffSignal2.value = false;
  Load2.switchOffSignal1.value = false;
  Load2.switchOffSignal2.value = false;
  Load3.switchOffSignal1.value = false;
  Load3.switchOffSignal2.value = false;
  Load5.switchOffSignal1.value = false;
  Load5.switchOffSignal2.value = false;
  Load6.switchOffSignal1.value = false;
  Load6.switchOffSignal2.value = false;
  Load8.switchOffSignal1.value = false;
  Load8.switchOffSignal2.value = false;
  Load9.switchOffSignal1.value = false;
  Load9.switchOffSignal2.value = false;
  Load10.switchOffSignal1.value = false;
  Load10.switchOffSignal2.value = false;
  Load12.switchOffSignal1.value = false;
  Load12.switchOffSignal2.value = false;
  Load13.switchOffSignal1.value = false;
  Load13.switchOffSignal2.value = false;
  Load14.switchOffSignal1.value = false;
  Load14.switchOffSignal2.value = false;
  Load15.switchOffSignal1.value = false;
  Load15.switchOffSignal2.value = false;
  Load16.switchOffSignal1.value = false;
  Load16.switchOffSignal2.value = false;
  Load17.switchOffSignal1.value = false;
  Load17.switchOffSignal2.value = false;
  Load18.switchOffSignal1.value = false;
  Load18.switchOffSignal2.value = false;
  Load19.switchOffSignal1.value = false;
  Load19.switchOffSignal2.value = false;
  Load20.switchOffSignal1.value = false;
  Load20.switchOffSignal2.value = false;
  Load23.switchOffSignal1.value = false;
  Load23.switchOffSignal2.value = false;
  Load25.switchOffSignal1.value = false;
  Load25.switchOffSignal2.value = false;
  Load27.switchOffSignal1.value = false;
  Load27.switchOffSignal2.value = false;
  Load28.switchOffSignal1.value = false;
  Load28.switchOffSignal2.value = false;
  Load29.switchOffSignal1.value = false;
  Load29.switchOffSignal2.value = false;
  Load30.switchOffSignal1.value = false;
  Load30.switchOffSignal2.value = false;
  Load31.switchOffSignal1.value = false;
  Load31.switchOffSignal2.value = false;
  Load32.switchOffSignal1.value = false;
  Load32.switchOffSignal2.value = false;
  Load33.switchOffSignal1.value = false;
  Load33.switchOffSignal2.value = false;
  Load35.switchOffSignal1.value = false;
  Load35.switchOffSignal2.value = false;
  Load38.switchOffSignal1.value = false;
  Load38.switchOffSignal2.value = false;
  Load41.switchOffSignal1.value = false;
  Load41.switchOffSignal2.value = false;
  Load42.switchOffSignal1.value = false;
  Load42.switchOffSignal2.value = false;
  Load43.switchOffSignal1.value = false;
  Load43.switchOffSignal2.value = false;
  Load44.switchOffSignal1.value = false;
  Load44.switchOffSignal2.value = false;
  Load47.switchOffSignal1.value = false;
  Load47.switchOffSignal2.value = false;
  Load49.switchOffSignal1.value = false;
  Load49.switchOffSignal2.value = false;
  Load50.switchOffSignal1.value = false;
  Load50.switchOffSignal2.value = false;
  Load51.switchOffSignal1.value = false;
  Load51.switchOffSignal2.value = false;
  Load52.switchOffSignal1.value = false;
  Load52.switchOffSignal2.value = false;
  Load53.switchOffSignal1.value = false;
  Load53.switchOffSignal2.value = false;
  Load54.switchOffSignal1.value = false;
  Load54.switchOffSignal2.value = false;
  Load55.switchOffSignal1.value = false;
  Load55.switchOffSignal2.value = false;
  Load56.switchOffSignal1.value = false;
  Load56.switchOffSignal2.value = false;
  Load57.switchOffSignal1.value = false;
  Load57.switchOffSignal2.value = false;

  Gen1.switchOffSignal1.value = false;
  Gen1.switchOffSignal2.value = false;
  Gen1.switchOffSignal3.value = false;
  Gen2.switchOffSignal1.value = false;
  Gen2.switchOffSignal2.value = false;
  Gen2.switchOffSignal3.value = false;
  Gen3.switchOffSignal1.value = false;
  Gen3.switchOffSignal2.value = false;
  Gen3.switchOffSignal3.value = false;
  Gen6.switchOffSignal1.value = false;
  Gen6.switchOffSignal2.value = false;
  Gen6.switchOffSignal3.value = false;
  Gen8.switchOffSignal1.value = false;
  Gen8.switchOffSignal2.value = false;
  Gen8.switchOffSignal3.value = false;
  Gen9.switchOffSignal1.value = false;
  Gen9.switchOffSignal2.value = false;
  Gen9.switchOffSignal3.value = false;
  Gen12.switchOffSignal1.value = false;
  Gen12.switchOffSignal2.value = false;
  Gen12.switchOffSignal3.value = false;

  LineB1B2.switchOffSignal1.value = false;
  LineB1B2.switchOffSignal2.value = false;
  LineB1B15.switchOffSignal1.value = false;
  LineB1B15.switchOffSignal2.value = false;
  LineB1B16.switchOffSignal1.value = false;
  LineB1B16.switchOffSignal2.value = false;
  LineB1B17.switchOffSignal1.value = false;
  LineB1B17.switchOffSignal2.value = false;
  LineB2B3.switchOffSignal1.value = false;
  LineB2B3.switchOffSignal2.value = false;
  LineB3B4.switchOffSignal1.value = false;
  LineB3B4.switchOffSignal2.value = false;
  LineB3B15.switchOffSignal1.value = false;
  LineB3B15.switchOffSignal2.value = false;
  LineB4B5.switchOffSignal1.value = false;
  LineB4B5.switchOffSignal2.value = false;
  LineB4B6.switchOffSignal1.value = false;
  LineB4B6.switchOffSignal2.value = false;
  LineB5B6.switchOffSignal1.value = false;
  LineB5B6.switchOffSignal2.value = false;
  LineB6B7.switchOffSignal1.value = false;
  LineB6B7.switchOffSignal2.value = false;
  LineB6B8.switchOffSignal1.value = false;
  LineB6B8.switchOffSignal2.value = false;
  LineB7B8.switchOffSignal1.value = false;
  LineB7B8.switchOffSignal2.value = false;
  LineB8B9.switchOffSignal1.value = false;
  LineB8B9.switchOffSignal2.value = false;
  LineB9B10.switchOffSignal1.value = false;
  LineB9B10.switchOffSignal2.value = false;
  LineB9B11.switchOffSignal1.value = false;
  LineB9B11.switchOffSignal2.value = false;
  LineB9B12.switchOffSignal1.value = false;
  LineB9B12.switchOffSignal2.value = false;
  LineB9B13.switchOffSignal1.value = false;
  LineB9B13.switchOffSignal2.value = false;
  LineB10B12.switchOffSignal1.value = false;
  LineB10B12.switchOffSignal2.value = false;
  LineB11B13.switchOffSignal1.value = false;
  LineB11B13.switchOffSignal2.value = false;
  LineB12B13.switchOffSignal1.value = false;
  LineB12B13.switchOffSignal2.value = false;
  LineB12B16.switchOffSignal1.value = false;
  LineB12B16.switchOffSignal2.value = false;
  LineB12B17.switchOffSignal1.value = false;
  LineB12B17.switchOffSignal2.value = false;
  LineB13B14.switchOffSignal1.value = false;
  LineB13B14.switchOffSignal2.value = false;
  LineB13B15.switchOffSignal1.value = false;
  LineB13B15.switchOffSignal2.value = false;
  LineB14B15.switchOffSignal1.value = false;
  LineB14B15.switchOffSignal2.value = false;
  LineB18B19.switchOffSignal1.value = false;
  LineB18B19.switchOffSignal2.value = false;
  LineB19B20.switchOffSignal1.value = false;
  LineB19B20.switchOffSignal2.value = false;
  LineB21B22.switchOffSignal1.value = false;
  LineB21B22.switchOffSignal2.value = false;
  LineB22B23.switchOffSignal1.value = false;
  LineB22B23.switchOffSignal2.value = false;
  LineB22B38.switchOffSignal1.value = false;
  LineB22B38.switchOffSignal2.value = false;
  LineB23B24.switchOffSignal1.value = false;
  LineB23B24.switchOffSignal2.value = false;
  LineB25B30.switchOffSignal1.value = false;
  LineB25B30.switchOffSignal2.value = false;
  LineB26B27.switchOffSignal1.value = false;
  LineB26B27.switchOffSignal2.value = false;
  LineB27B28.switchOffSignal1.value = false;
  LineB27B28.switchOffSignal2.value = false;
  LineB28B29.switchOffSignal1.value = false;
  LineB28B29.switchOffSignal2.value = if time < 100 then false else true; // Disconnecting line B28B29
  LineB29B52.switchOffSignal1.value = false;
  LineB29B52.switchOffSignal2.value = false;
  LineB30B31.switchOffSignal1.value = false;
  LineB30B31.switchOffSignal2.value = false;
  LineB31B32.switchOffSignal1.value = false;
  LineB31B32.switchOffSignal2.value = false;
  LineB32B33.switchOffSignal1.value = false;
  LineB32B33.switchOffSignal2.value = false;
  LineB34B35.switchOffSignal1.value = false;
  LineB34B35.switchOffSignal2.value = false;
  LineB35B36.switchOffSignal1.value = false;
  LineB35B36.switchOffSignal2.value = false;
  LineB36B37.switchOffSignal1.value = false;
  LineB36B37.switchOffSignal2.value = false;
  LineB36B40.switchOffSignal1.value = false;
  LineB36B40.switchOffSignal2.value = false;
  LineB37B38.switchOffSignal1.value = false;
  LineB37B38.switchOffSignal2.value = false;
  LineB37B39.switchOffSignal1.value = false;
  LineB37B39.switchOffSignal2.value = false;
  LineB38B44.switchOffSignal1.value = false;
  LineB38B44.switchOffSignal2.value = false;
  LineB38B48.switchOffSignal1.value = false;
  LineB38B48.switchOffSignal2.value = false;
  LineB38B49.switchOffSignal1.value = false;
  LineB38B49.switchOffSignal2.value = false;
  LineB41B42.switchOffSignal1.value = false;
  LineB41B42.switchOffSignal2.value = false;
  LineB41B43.switchOffSignal1.value = false;
  LineB41B43.switchOffSignal2.value = false;
  LineB44B45.switchOffSignal1.value = false;
  LineB44B45.switchOffSignal2.value = false;
  LineB46B47.switchOffSignal1.value = false;
  LineB46B47.switchOffSignal2.value = false;
  LineB47B48.switchOffSignal1.value = false;
  LineB47B48.switchOffSignal2.value = false;
  LineB48B49.switchOffSignal1.value = false;
  LineB48B49.switchOffSignal2.value = false;
  LineB49B50.switchOffSignal1.value = false;
  LineB49B50.switchOffSignal2.value = false;
  LineB50B51.switchOffSignal1.value = false;
  LineB50B51.switchOffSignal2.value = false;
  LineB52B53.switchOffSignal1.value = false;
  LineB52B53.switchOffSignal2.value = false;
  LineB53B54.switchOffSignal1.value = false;
  LineB53B54.switchOffSignal2.value = false;
  LineB54B55.switchOffSignal1.value = false;
  LineB54B55.switchOffSignal2.value = false;
  LineB56B41.switchOffSignal1.value = false;
  LineB56B41.switchOffSignal2.value = false;
  LineB56B42.switchOffSignal1.value = false;
  LineB56B42.switchOffSignal2.value = false;
  LineB57B56.switchOffSignal1.value = false;
  LineB57B56.switchOffSignal2.value = false;

  TfoB10B51.switchOffSignal1.value = false;
  TfoB10B51.switchOffSignal2.value = false;
  TfoB13B49.switchOffSignal1.value = false;
  TfoB13B49.switchOffSignal2.value = false;
  TfoB14B46.switchOffSignal1.value = false;
  TfoB14B46.switchOffSignal2.value = false;
  TfoB15B45.switchOffSignal1.value = false;
  TfoB15B45.switchOffSignal2.value = false;
  TfoB21B20.switchOffSignal1.value = false;
  TfoB21B20.switchOffSignal2.value = false;
  TfoB24B26.switchOffSignal1.value = false;
  TfoB24B26.switchOffSignal2.value = false;
  TfoB24B25_1.switchOffSignal1.value = false;
  TfoB24B25_1.switchOffSignal2.value = false;
  TfoB24B25_2.switchOffSignal1.value = false;
  TfoB24B25_2.switchOffSignal2.value = false;
  TfoB34B32.switchOffSignal1.value = false;
  TfoB34B32.switchOffSignal2.value = false;
  TfoB39B57.switchOffSignal1.value = false;
  TfoB39B57.switchOffSignal2.value = false;
  TfoB40B56.switchOffSignal1.value = false;
  TfoB40B56.switchOffSignal2.value = false;
  TfoB7B29.switchOffSignal1.value = false;
  TfoB7B29.switchOffSignal2.value = false;
  TfoB9B55.switchOffSignal1.value = false;
  TfoB9B55.switchOffSignal2.value = false;
  TfoB4B18_1.switchOffSignal1.value = false;
  TfoB4B18_1.switchOffSignal2.value = false;
  TfoB4B18_2.switchOffSignal1.value = false;
  TfoB4B18_2.switchOffSignal2.value = false;
  TfoB11B43.switchOffSignal1.value = false;
  TfoB11B43.switchOffSignal2.value = false;
  TfoB11B41.switchOffSignal1.value = false;
  TfoB11B41.switchOffSignal2.value = false;

  Shunt18.switchOffSignal1.value = false;
  Shunt18.switchOffSignal2.value = false;
  Shunt25.switchOffSignal1.value = false;
  Shunt25.switchOffSignal2.value = false;
  Shunt53.switchOffSignal1.value = false;
  Shunt53.switchOffSignal2.value = false;

  annotation(preferredView = "text",
    experiment(StartTime = 0, StopTime = 30, Tolerance = 1e-6, Interval = 10),
    __OpenModelica_commandLineOptions = "--matchingAlgorithm=PFPlusExt --indexReductionMethod=dynamicStateSelection -d=initialization,NLSanalyticJacobian --daeMode",
    __OpenModelica_simulationFlags(ls = "klu", lv = "LOG_STATS", nls = "kinsol", s = "euler"),
  Documentation(info = "<html><head></head><body>At t = 100 s, LineB28B29 is disconnected.</body></html>"));
end IEEE57DisconnectLine;
