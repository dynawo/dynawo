diff --git a/extensions/entsoe/resources/entsoeArea.xml b/extensions/entsoe/resources/entsoeArea.xml
index 01db8bf6..2416c517 100644
--- a/extensions/entsoe/resources/entsoeArea.xml
+++ b/extensions/entsoe/resources/entsoeArea.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:ea="http://www.itesla_project.eu/schema/iidm/ext/entsoe_area/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:ea="http://www.itesla_project.eu/schema/iidm/ext/entsoe_area/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="S" country="FR"/>
     <iidm:extension id="S">
         <ea:entsoeArea>FR</ea:entsoeArea>
diff --git a/extensions/entsoe/resources/mergedXnode.xml b/extensions/entsoe/resources/mergedXnode.xml
index 293f3566..bdba9fcd 100644
--- a/extensions/entsoe/resources/mergedXnode.xml
+++ b/extensions/entsoe/resources/mergedXnode.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:mxn="http://www.itesla_project.eu/schema/iidm/ext/merged_xnode/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:mxn="http://www.itesla_project.eu/schema/iidm/ext/merged_xnode/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="S1" country="FR">
         <iidm:voltageLevel id="VL1" nominalV="400" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/entsoe/resources/xnode.xml b/extensions/entsoe/resources/xnode.xml
index 28b466dd..44288523 100644
--- a/extensions/entsoe/resources/xnode.xml
+++ b/extensions/entsoe/resources/xnode.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:xn="http://www.itesla_project.eu/schema/iidm/ext/xnode/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:xn="http://www.itesla_project.eu/schema/iidm/ext/xnode/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="S" country="FR">
         <iidm:voltageLevel id="VL" nominalV="400" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/entsoe/src/EntsoeAreaXmlSerializer.cpp b/extensions/entsoe/src/EntsoeAreaXmlSerializer.cpp
index 91460c87..cb1cb154 100644
--- a/extensions/entsoe/src/EntsoeAreaXmlSerializer.cpp
+++ b/extensions/entsoe/src/EntsoeAreaXmlSerializer.cpp
@@ -43,7 +43,7 @@ Extension& EntsoeAreaXmlSerializer::read(Extendable& extendable, converter::xml:
 
 void EntsoeAreaXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& entsoeArea = safeCast<EntsoeArea>(extension);
-    context.getExtensionsWriter().writeCharacters(Enum::toString<EntsoeGeographicalCode>(entsoeArea.getCode()));
+    context.getWriter().writeCharacters(Enum::toString<EntsoeGeographicalCode>(entsoeArea.getCode()));
 }
 
 }  // namespace entsoe
diff --git a/extensions/entsoe/src/MergedXnodeXmlSerializer.cpp b/extensions/entsoe/src/MergedXnodeXmlSerializer.cpp
index dedf52aa..064a6cb0 100644
--- a/extensions/entsoe/src/MergedXnodeXmlSerializer.cpp
+++ b/extensions/entsoe/src/MergedXnodeXmlSerializer.cpp
@@ -45,13 +45,13 @@ Extension& MergedXnodeXmlSerializer::read(Extendable& extendable, converter::xml
 
 void MergedXnodeXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& mergedXnode = safeCast<MergedXnode>(extension);
-    context.getExtensionsWriter().writeAttribute("rdp", mergedXnode.getRdp());
-    context.getExtensionsWriter().writeAttribute("xdp", mergedXnode.getXdp());
-    context.getExtensionsWriter().writeAttribute("xnodeP1", mergedXnode.getXnodeP1());
-    context.getExtensionsWriter().writeAttribute("xnodeQ1", mergedXnode.getXnodeQ1());
-    context.getExtensionsWriter().writeAttribute("xnodeP2", mergedXnode.getXnodeP2());
-    context.getExtensionsWriter().writeAttribute("xnodeQ2", mergedXnode.getXnodeQ2());
-    context.getExtensionsWriter().writeAttribute("code", mergedXnode.getCode());
+    context.getWriter().writeAttribute("rdp", mergedXnode.getRdp());
+    context.getWriter().writeAttribute("xdp", mergedXnode.getXdp());
+    context.getWriter().writeAttribute("xnodeP1", mergedXnode.getXnodeP1());
+    context.getWriter().writeAttribute("xnodeQ1", mergedXnode.getXnodeQ1());
+    context.getWriter().writeAttribute("xnodeP2", mergedXnode.getXnodeP2());
+    context.getWriter().writeAttribute("xnodeQ2", mergedXnode.getXnodeQ2());
+    context.getWriter().writeAttribute("code", mergedXnode.getCode());
 }
 
 }  // namespace entsoe
diff --git a/extensions/entsoe/src/XnodeXmlSerializer.cpp b/extensions/entsoe/src/XnodeXmlSerializer.cpp
index d99ee9ed..9917530e 100644
--- a/extensions/entsoe/src/XnodeXmlSerializer.cpp
+++ b/extensions/entsoe/src/XnodeXmlSerializer.cpp
@@ -38,7 +38,7 @@ Extension& XnodeXmlSerializer::read(Extendable& extendable, converter::xml::Netw
 
 void XnodeXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& xnode = safeCast<Xnode>(extension);
-    context.getExtensionsWriter().writeAttribute("code", xnode.getCode());
+    context.getWriter().writeAttribute("code", xnode.getCode());
 }
 
 }  // namespace entsoe
diff --git a/extensions/iidm/resources/activePowerControl.xml b/extensions/iidm/resources/activePowerControl.xml
index e4c8047a..83cbbb59 100644
--- a/extensions/iidm/resources/activePowerControl.xml
+++ b/extensions/iidm/resources/activePowerControl.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:apc="http://www.itesla_project.eu/schema/iidm/ext/active_power_control/1_0" id="fictitious" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:apc="http://www.itesla_project.eu/schema/iidm/ext/active_power_control/1_0" id="fictitious" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="P1" country="FR" tso="R" geographicalTags="A">
         <iidm:voltageLevel id="VLGEN" nominalV="400" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/iidm/resources/coordinatedReactiveControl.xml b/extensions/iidm/resources/coordinatedReactiveControl.xml
index 15c34d50..3e6ccb49 100644
--- a/extensions/iidm/resources/coordinatedReactiveControl.xml
+++ b/extensions/iidm/resources/coordinatedReactiveControl.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:crc="http://www.powsybl.org/schema/iidm/ext/coordinated_reactive_control/1_0" id="sim1" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:crc="http://www.powsybl.org/schema/iidm/ext/coordinated_reactive_control/1_0" id="sim1" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
         <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/iidm/resources/threeWindingsTransformerPhaseAngleClock.xml b/extensions/iidm/resources/threeWindingsTransformerPhaseAngleClock.xml
index db6fd3c4..0fc9c87a 100644
--- a/extensions/iidm/resources/threeWindingsTransformerPhaseAngleClock.xml
+++ b/extensions/iidm/resources/threeWindingsTransformerPhaseAngleClock.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:threewtpac="http://www.powsybl.org/schema/iidm/ext/three_windings_transformer_phase_angle_clock/1_0" id="three-windings-transformer" caseDate="2018-03-05T13:30:30.486000+01:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:threewtpac="http://www.powsybl.org/schema/iidm/ext/three_windings_transformer_phase_angle_clock/1_0" id="three-windings-transformer" caseDate="2018-03-05T13:30:30.486000+01:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="SUBSTATION" country="FR">
         <iidm:voltageLevel id="VL_132" nominalV="132" lowVoltageLimit="118.8" highVoltageLimit="145.19999999999999" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/iidm/resources/twoWindingsTransformerPhaseAngleClock.xml b/extensions/iidm/resources/twoWindingsTransformerPhaseAngleClock.xml
index 946ad557..8a8dd3bc 100644
--- a/extensions/iidm/resources/twoWindingsTransformerPhaseAngleClock.xml
+++ b/extensions/iidm/resources/twoWindingsTransformerPhaseAngleClock.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:twowtpac="http://www.powsybl.org/schema/iidm/ext/two_windings_transformer_phase_angle_clock/1_0" id="sim1" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:twowtpac="http://www.powsybl.org/schema/iidm/ext/two_windings_transformer_phase_angle_clock/1_0" id="sim1" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
         <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/iidm/resources/voltagePerReactivePowerControl.xml b/extensions/iidm/resources/voltagePerReactivePowerControl.xml
index 86548f69..643956dd 100644
--- a/extensions/iidm/resources/voltagePerReactivePowerControl.xml
+++ b/extensions/iidm/resources/voltagePerReactivePowerControl.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:vprpc="http://www.powsybl.org/schema/iidm/ext/voltage_per_reactive_power_control/1_0" id="svcTestCase" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="code">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:vprpc="http://www.powsybl.org/schema/iidm/ext/voltage_per_reactive_power_control/1_0" id="svcTestCase" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="code">
     <iidm:substation id="S1" country="FR">
         <iidm:voltageLevel id="VL1" nominalV="380" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/iidm/src/ActivePowerControlXmlSerializer.cpp b/extensions/iidm/src/ActivePowerControlXmlSerializer.cpp
index 6a2305f7..5d03fb56 100644
--- a/extensions/iidm/src/ActivePowerControlXmlSerializer.cpp
+++ b/extensions/iidm/src/ActivePowerControlXmlSerializer.cpp
@@ -45,8 +45,8 @@ Extension& ActivePowerControlXmlSerializer::read(Extendable& extendable, convert
 void ActivePowerControlXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& apc = safeCast<ActivePowerControl>(extension);
 
-    context.getExtensionsWriter().writeAttribute("participate", apc.isParticipate());
-    context.getExtensionsWriter().writeAttribute("droop", apc.getDroop());
+    context.getWriter().writeAttribute("participate", apc.isParticipate());
+    context.getWriter().writeAttribute("droop", apc.getDroop());
 }
 
 }  // namespace iidm
diff --git a/extensions/iidm/src/CoordinatedReactiveControlXmlSerializer.cpp b/extensions/iidm/src/CoordinatedReactiveControlXmlSerializer.cpp
index ed902dee..335951d2 100644
--- a/extensions/iidm/src/CoordinatedReactiveControlXmlSerializer.cpp
+++ b/extensions/iidm/src/CoordinatedReactiveControlXmlSerializer.cpp
@@ -43,7 +43,7 @@ Extension& CoordinatedReactiveControlXmlSerializer::read(Extendable& extendable,
 
 void CoordinatedReactiveControlXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& crc = safeCast<CoordinatedReactiveControl>(extension);
-    context.getExtensionsWriter().writeAttribute("qPercent", crc.getQPercent());
+    context.getWriter().writeAttribute("qPercent", crc.getQPercent());
 }
 
 }  // namespace iidm
diff --git a/extensions/iidm/src/ThreeWindingsTransformerPhaseAngleClockXmlSerializer.cpp b/extensions/iidm/src/ThreeWindingsTransformerPhaseAngleClockXmlSerializer.cpp
index 9a248a1b..807083fd 100644
--- a/extensions/iidm/src/ThreeWindingsTransformerPhaseAngleClockXmlSerializer.cpp
+++ b/extensions/iidm/src/ThreeWindingsTransformerPhaseAngleClockXmlSerializer.cpp
@@ -45,8 +45,8 @@ Extension& ThreeWindingsTransformerPhaseAngleClockXmlSerializer::read(Extendable
     void ThreeWindingsTransformerPhaseAngleClockXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
         const auto& ext = safeCast<ThreeWindingsTransformerPhaseAngleClock>(extension);
 
-        context.getExtensionsWriter().writeOptionalAttribute("phaseAngleClockLeg2", ext.getPhaseAngleClockLeg2(), 0UL);
-        context.getExtensionsWriter().writeOptionalAttribute("phaseAngleClockLeg3", ext.getPhaseAngleClockLeg3(), 0UL);
+        context.getWriter().writeOptionalAttribute("phaseAngleClockLeg2", ext.getPhaseAngleClockLeg2(), 0UL);
+        context.getWriter().writeOptionalAttribute("phaseAngleClockLeg3", ext.getPhaseAngleClockLeg3(), 0UL);
     }
 
 }  // namespace iidm
diff --git a/extensions/iidm/src/TwoWindingsTransformerPhaseAngleClockXmlSerializer.cpp b/extensions/iidm/src/TwoWindingsTransformerPhaseAngleClockXmlSerializer.cpp
index 37d95c48..f6140c0e 100644
--- a/extensions/iidm/src/TwoWindingsTransformerPhaseAngleClockXmlSerializer.cpp
+++ b/extensions/iidm/src/TwoWindingsTransformerPhaseAngleClockXmlSerializer.cpp
@@ -42,7 +42,7 @@ Extension& TwoWindingsTransformerPhaseAngleClockXmlSerializer::read(Extendable&
 void TwoWindingsTransformerPhaseAngleClockXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& ext = safeCast<TwoWindingsTransformerPhaseAngleClock>(extension);
 
-    context.getExtensionsWriter().writeOptionalAttribute("phaseAngleClock", ext.getPhaseAngleClock(), 0UL);
+    context.getWriter().writeOptionalAttribute("phaseAngleClock", ext.getPhaseAngleClock(), 0UL);
 }
 
 }  // namespace iidm
diff --git a/extensions/iidm/src/VoltagePerReactivePowerControlXmlSerializer.cpp b/extensions/iidm/src/VoltagePerReactivePowerControlXmlSerializer.cpp
index f98efb33..c6094d96 100644
--- a/extensions/iidm/src/VoltagePerReactivePowerControlXmlSerializer.cpp
+++ b/extensions/iidm/src/VoltagePerReactivePowerControlXmlSerializer.cpp
@@ -40,7 +40,7 @@ Extension& VoltagePerReactivePowerControlXmlSerializer::read(Extendable& extenda
 void VoltagePerReactivePowerControlXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& ext = safeCast<VoltagePerReactivePowerControl>(extension);
 
-    context.getExtensionsWriter().writeAttribute("slope", ext.getSlope());
+    context.getWriter().writeAttribute("slope", ext.getSlope());
 }
 
 }  // namespace iidm
diff --git a/extensions/sld/resources/busbarSectionPosition.xml b/extensions/sld/resources/busbarSectionPosition.xml
index 07dcfe35..f1cdfadd 100644
--- a/extensions/sld/resources/busbarSectionPosition.xml
+++ b/extensions/sld/resources/busbarSectionPosition.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:bbsp="http://www.itesla_project.eu/schema/iidm/ext/busbarsectionposition/1_0" id="test" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:bbsp="http://www.itesla_project.eu/schema/iidm/ext/busbarsectionposition/1_0" id="test" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="S" country="FR">
         <iidm:voltageLevel id="VL" nominalV="400" lowVoltageLimit="380" highVoltageLimit="420" topologyKind="NODE_BREAKER">
             <iidm:nodeBreakerTopology>
diff --git a/extensions/sld/resources/connectablePositionFeeder0.xml b/extensions/sld/resources/connectablePositionFeeder0.xml
index f36c1a53..071e2ceb 100644
--- a/extensions/sld/resources/connectablePositionFeeder0.xml
+++ b/extensions/sld/resources/connectablePositionFeeder0.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:cp="http://www.itesla_project.eu/schema/iidm/ext/connectable_position/1_0" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:cp="http://www.itesla_project.eu/schema/iidm/ext/connectable_position/1_0" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
         <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/sld/resources/connectablePositionFeeders123.xml b/extensions/sld/resources/connectablePositionFeeders123.xml
index b9b5dd84..d75d6e3f 100644
--- a/extensions/sld/resources/connectablePositionFeeders123.xml
+++ b/extensions/sld/resources/connectablePositionFeeders123.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_4" xmlns:cp="http://www.itesla_project.eu/schema/iidm/ext/connectable_position/1_0" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:cp="http://www.itesla_project.eu/schema/iidm/ext/connectable_position/1_0" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
     <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
         <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
             <iidm:busBreakerTopology>
diff --git a/extensions/sld/src/BusbarSectionPositionXmlSerializer.cpp b/extensions/sld/src/BusbarSectionPositionXmlSerializer.cpp
index e6f4c81b..4239174a 100644
--- a/extensions/sld/src/BusbarSectionPositionXmlSerializer.cpp
+++ b/extensions/sld/src/BusbarSectionPositionXmlSerializer.cpp
@@ -39,8 +39,8 @@ Extension& BusbarSectionPositionXmlSerializer::read(Extendable& extendable, conv
 
 void BusbarSectionPositionXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& busbarSectionPosition = safeCast<BusbarSectionPosition>(extension);
-    context.getExtensionsWriter().writeAttribute("busbarIndex", busbarSectionPosition.getBusbarIndex());
-    context.getExtensionsWriter().writeAttribute("sectionIndex", busbarSectionPosition.getSectionIndex());
+    context.getWriter().writeAttribute("busbarIndex", busbarSectionPosition.getBusbarIndex());
+    context.getWriter().writeAttribute("sectionIndex", busbarSectionPosition.getSectionIndex());
 }
 
 }  // namespace sld
diff --git a/extensions/sld/src/ConnectablePositionXmlSerializer.cpp b/extensions/sld/src/ConnectablePositionXmlSerializer.cpp
index d25a40fd..f0d36191 100644
--- a/extensions/sld/src/ConnectablePositionXmlSerializer.cpp
+++ b/extensions/sld/src/ConnectablePositionXmlSerializer.cpp
@@ -82,11 +82,11 @@ void ConnectablePositionXmlSerializer::writePosition(const ConnectablePosition::
     if (index) {
         elementName += std::to_string(*index);
     }
-    context.getExtensionsWriter().writeStartElement(getNamespacePrefix(), elementName);
-    context.getExtensionsWriter().writeAttribute("name", feeder.getName());
-    context.getExtensionsWriter().writeAttribute("order", feeder.getOrder());
-    context.getExtensionsWriter().writeAttribute("direction", Enum::toString(feeder.getDirection()));
-    context.getExtensionsWriter().writeEndElement();
+    context.getWriter().writeStartElement(getNamespacePrefix(), elementName);
+    context.getWriter().writeAttribute("name", feeder.getName());
+    context.getWriter().writeAttribute("order", feeder.getOrder());
+    context.getWriter().writeAttribute("direction", Enum::toString(feeder.getDirection()));
+    context.getWriter().writeEndElement();
 }
 
 }  // namespace sld
diff --git a/include/powsybl/iidm/converter/xml/ExtensionXmlSerializer.hpp b/include/powsybl/iidm/converter/xml/ExtensionXmlSerializer.hpp
index 183dd806..3d31f73e 100644
--- a/include/powsybl/iidm/converter/xml/ExtensionXmlSerializer.hpp
+++ b/include/powsybl/iidm/converter/xml/ExtensionXmlSerializer.hpp
@@ -95,6 +95,13 @@ public:
      */
     virtual const std::string& getVersion() const;
 
+    /**
+     * Return true if the extension is serializable, false else
+     *
+     * @return true if the extension is serializable, false else
+     */
+    virtual bool isSerializable(const Extension& extension) const;
+
     /**
      * Create an extension from its XML serialization
      *
diff --git a/include/powsybl/iidm/converter/xml/IidmXmlVersion.hpp b/include/powsybl/iidm/converter/xml/IidmXmlVersion.hpp
index 9e7205cd..202cad97 100644
--- a/include/powsybl/iidm/converter/xml/IidmXmlVersion.hpp
+++ b/include/powsybl/iidm/converter/xml/IidmXmlVersion.hpp
@@ -52,6 +52,11 @@ public:
      */
     static const IidmXmlVersion& V1_4();
 
+    /**
+     * IIDM V1.5 (http://www.powsybl.org)
+     */
+    static const IidmXmlVersion& V1_5();
+
 public:
     /**
      * Return the list of all supported XIIDM versions
diff --git a/include/powsybl/iidm/converter/xml/NetworkXmlWriterContext.hpp b/include/powsybl/iidm/converter/xml/NetworkXmlWriterContext.hpp
index 2dfde347..116efd38 100644
--- a/include/powsybl/iidm/converter/xml/NetworkXmlWriterContext.hpp
+++ b/include/powsybl/iidm/converter/xml/NetworkXmlWriterContext.hpp
@@ -51,8 +51,6 @@ public:
 
     const std::string& getExtensionVersion(const std::string& extensionName) const;
 
-    powsybl::xml::XmlStreamWriter& getExtensionsWriter();
-
     const BusFilter& getFilter() const;
 
     const ExportOptions& getOptions() const;
@@ -63,13 +61,9 @@ public:
 
     bool isExportedEquipment(const std::string& id);
 
-    void setExtensionsWriter(powsybl::xml::XmlStreamWriter& extensionsWriter);
-
 private:
     powsybl::xml::XmlStreamWriter& m_writer;
 
-    std::reference_wrapper<powsybl::xml::XmlStreamWriter> m_extensionsWriter;
-
     std::unique_ptr<Anonymizer> m_anonymizer;
 
     ExportOptions m_options;
diff --git a/include/powsybl/iidm/converter/xml/TerminalRefXml.hpp b/include/powsybl/iidm/converter/xml/TerminalRefXml.hpp
index d267f88f..fe45a8b4 100644
--- a/include/powsybl/iidm/converter/xml/TerminalRefXml.hpp
+++ b/include/powsybl/iidm/converter/xml/TerminalRefXml.hpp
@@ -40,6 +40,8 @@ public:
 
     static void writeTerminalRef(const Terminal& terminal, NetworkXmlWriterContext& context, const std::string& nsPrefix, const std::string& elementName, powsybl::xml::XmlStreamWriter& writer);
 
+    static void writeTerminalRefAttribute(const Terminal& terminal, NetworkXmlWriterContext& context);
+
 private:
     TerminalRefXml() = default;
 
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index 9cd4a766..2f9e5f95 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -181,6 +181,7 @@ set(IIDM_SOURCES
     iidm/extensions/LoadDetailXmlSerializer.cpp
     iidm/extensions/SlackTerminal.cpp
     iidm/extensions/SlackTerminalAdder.cpp
+    iidm/extensions/SlackTerminalXmlSerializer.cpp
 
     iidm/util/ConnectedComponents.cpp
     iidm/util/DistinctPredicate.cpp
diff --git a/src/iidm/ExtensionProviders.cpp b/src/iidm/ExtensionProviders.cpp
index cf0d07c3..c3b10066 100644
--- a/src/iidm/ExtensionProviders.cpp
+++ b/src/iidm/ExtensionProviders.cpp
@@ -19,6 +19,7 @@
 #include <powsybl/stdcxx/format.hpp>
 
 #include "extensions/LoadDetailXmlSerializer.hpp"
+#include "extensions/SlackTerminalXmlSerializer.hpp"
 
 namespace powsybl {
 
@@ -27,6 +28,7 @@ namespace iidm {
 template <>
 ExtensionProviders<converter::xml::ExtensionXmlSerializer, void>::ExtensionProviders() {
     registerExtension(stdcxx::make_unique<extensions::LoadDetailXmlSerializer>());
+    registerExtension(stdcxx::make_unique<extensions::SlackTerminalXmlSerializer>());
 }
 
 template <typename T, typename Dummy>
@@ -45,7 +47,7 @@ template <typename T, typename Dummy>
 const T& ExtensionProviders<T, Dummy>::findProviderOrThrowException(const std::string& name) const {
     const auto& it = m_providers.find(name);
     if (it == m_providers.end()) {
-        throw PowsyblException(stdcxx::format("No provider found for extension '%1'", name));
+        throw PowsyblException(stdcxx::format("No provider found for extension '%1%'", name));
     }
     return *it->second;
 }
diff --git a/src/iidm/NodeBreakerVoltageLevel.cpp b/src/iidm/NodeBreakerVoltageLevel.cpp
index 4dd8b852..85521c91 100644
--- a/src/iidm/NodeBreakerVoltageLevel.cpp
+++ b/src/iidm/NodeBreakerVoltageLevel.cpp
@@ -68,6 +68,10 @@ void NodeBreakerVoltageLevel::attach(Terminal& terminal, bool test) {
 
         // create the link terminal <-> graph vertex
         m_graph.setVertexObject(node, stdcxx::ref(nodeTerminal));
+
+        getNetwork().getVariantManager().forEachVariant([this]() {
+            invalidateCache();
+        });
     }
 }
 
@@ -125,7 +129,9 @@ void NodeBreakerVoltageLevel::detach(Terminal& terminal) {
     assert(node < m_graph.getVertexCount());
     assert(stdcxx::areSame(m_graph.getVertexObject(node).get(), nodeTerminal));
 
-    invalidateCache();
+    getNetwork().getVariantManager().forEachVariant([this]() {
+        invalidateCache();
+    });
 
     // remove the link terminal <-> graph vertex
     m_graph.setVertexObject(node, stdcxx::ref<NodeTerminal>());
diff --git a/src/iidm/converter/xml/ExtensionXmlSerializer.cpp b/src/iidm/converter/xml/ExtensionXmlSerializer.cpp
index 4ee9130c..f0ad0720 100644
--- a/src/iidm/converter/xml/ExtensionXmlSerializer.cpp
+++ b/src/iidm/converter/xml/ExtensionXmlSerializer.cpp
@@ -46,6 +46,10 @@ const std::string& ExtensionXmlSerializer::getVersion() const {
     return s_version;
 }
 
+bool ExtensionXmlSerializer::isSerializable(const Extension& /*extension*/) const {
+    return true;
+}
+
 }  // namespace xml
 
 }  // namespace converter
diff --git a/src/iidm/converter/xml/IidmXmlVersion.cpp b/src/iidm/converter/xml/IidmXmlVersion.cpp
index 4a2d646a..faa73e77 100644
--- a/src/iidm/converter/xml/IidmXmlVersion.cpp
+++ b/src/iidm/converter/xml/IidmXmlVersion.cpp
@@ -65,7 +65,8 @@ const IidmXmlVersions& IidmXmlVersion::all() {
         std::cref(IidmXmlVersion::V1_1()),
         std::cref(IidmXmlVersion::V1_2()),
         std::cref(IidmXmlVersion::V1_3()),
-        std::cref(IidmXmlVersion::V1_4())
+        std::cref(IidmXmlVersion::V1_4()),
+        std::cref(IidmXmlVersion::V1_5())
     }};
 
     return s_versions;
@@ -145,6 +146,11 @@ const IidmXmlVersion& IidmXmlVersion::V1_4() {
     return V1_4;
 }
 
+const IidmXmlVersion& IidmXmlVersion::V1_5() {
+    static IidmXmlVersion V1_5("powsybl.org", {{1, 5}});
+    return V1_5;
+}
+
 }  // namespace xml
 
 }  // namespace converter
diff --git a/src/iidm/converter/xml/NetworkXml.cpp b/src/iidm/converter/xml/NetworkXml.cpp
index e810a60b..3deb0fc6 100644
--- a/src/iidm/converter/xml/NetworkXml.cpp
+++ b/src/iidm/converter/xml/NetworkXml.cpp
@@ -68,17 +68,21 @@ std::set<std::string> getExtensionNames(const Network& network) {
     return names;
 }
 
-stdcxx::CReference<ExtensionXmlSerializer> getExtensionSerializer(const ExportOptions& options, const std::string& extensionName) {
+stdcxx::CReference<ExtensionXmlSerializer> getExtensionSerializer(const ExportOptions& options, const Extension& extension) {
     powsybl::iidm::ExtensionProviders<ExtensionXmlSerializer>& extensionProviders = powsybl::iidm::ExtensionProviders<ExtensionXmlSerializer>::getInstance();
 
     stdcxx::CReference<ExtensionXmlSerializer> serializer;
     if (options.isThrowExceptionIfExtensionNotFound()) {
-        serializer = stdcxx::cref(extensionProviders.findProviderOrThrowException(extensionName));
+        serializer = stdcxx::cref(extensionProviders.findProviderOrThrowException(extension.getName()));
     } else {
-        serializer = extensionProviders.findProvider(extensionName);
-        if (!serializer) {
+        serializer = extensionProviders.findProvider(extension.getName());
+        if (serializer) {
+            if (!serializer.get().isSerializable(extension)) {
+                serializer.reset();
+            }
+        } else {
             logging::Logger& logger = logging::LoggerFactory::getLogger<NetworkXml>();
-            logger.warn("No extension XML serializer for %1%", extensionName);
+            logger.warn("No extension XML serializer for %1%", extension.getName());
         }
     }
 
@@ -163,8 +167,8 @@ void writeExtensionNamespaces(const Network& network, NetworkXmlWriterContext& c
 }
 
 void writeExtension(const Extension& extension, NetworkXmlWriterContext& context) {
-    powsybl::xml::XmlStreamWriter& writer = context.getExtensionsWriter();
-    stdcxx::CReference<ExtensionXmlSerializer> serializer = getExtensionSerializer(context.getOptions(), extension.getName());
+    powsybl::xml::XmlStreamWriter& writer = context.getWriter();
+    stdcxx::CReference<ExtensionXmlSerializer> serializer = getExtensionSerializer(context.getOptions(), extension);
     if (!serializer) {
         throw AssertionError(stdcxx::format("Extension XML Serializer of %1% should not be null", extension.getName()));
     }
@@ -184,14 +188,14 @@ void writeExtensions(const Network& network, NetworkXmlWriterContext& context) {
         if (!context.isExportedEquipment(identifiable.getId()) || boost::empty(identifiable.getExtensions()) || !context.getOptions().hasAtLeastOneExtension(identifiable.getExtensions())) {
             continue;
         }
-        context.getExtensionsWriter().writeStartElement(context.getVersion().getPrefix(), EXTENSION);
-        context.getExtensionsWriter().writeAttribute(ID, context.getAnonymizer().anonymizeString(identifiable.getId()));
+        context.getWriter().writeStartElement(context.getVersion().getPrefix(), EXTENSION);
+        context.getWriter().writeAttribute(ID, context.getAnonymizer().anonymizeString(identifiable.getId()));
         for (const auto& extension : identifiable.getExtensions()) {
             if (context.getOptions().withExtension(extension.getName())) {
                 writeExtension(extension, context);
             }
         }
-        context.getExtensionsWriter().writeEndElement();
+        context.getWriter().writeEndElement();
     }
 }
 
diff --git a/src/iidm/converter/xml/NetworkXmlWriterContext.cpp b/src/iidm/converter/xml/NetworkXmlWriterContext.cpp
index 6567929f..c78b1062 100644
--- a/src/iidm/converter/xml/NetworkXmlWriterContext.cpp
+++ b/src/iidm/converter/xml/NetworkXmlWriterContext.cpp
@@ -20,7 +20,6 @@ namespace xml {
 
 NetworkXmlWriterContext::NetworkXmlWriterContext(std::unique_ptr<Anonymizer>&& anonymizer, powsybl::xml::XmlStreamWriter& writer, const ExportOptions& options, const BusFilter& filter, const IidmXmlVersion& version) :
     m_writer(writer),
-    m_extensionsWriter(writer),
     m_anonymizer(std::move(anonymizer)),
     m_options(options),
     m_version(version),
@@ -48,10 +47,6 @@ const std::string& NetworkXmlWriterContext::getExtensionVersion(const std::strin
     return m_options.getExtensionVersion(extensionName);
 }
 
-powsybl::xml::XmlStreamWriter& NetworkXmlWriterContext::getExtensionsWriter() {
-    return m_extensionsWriter.get();
-}
-
 const BusFilter& NetworkXmlWriterContext::getFilter() const {
     return m_filter;
 }
@@ -72,10 +67,6 @@ bool NetworkXmlWriterContext::isExportedEquipment(const std::string& id) {
     return m_exportedEquipments.find(id) != m_exportedEquipments.end();
 }
 
-void NetworkXmlWriterContext::setExtensionsWriter(powsybl::xml::XmlStreamWriter& extensionsWriter) {
-    m_extensionsWriter = std::ref(extensionsWriter);
-}
-
 }  // namespace xml
 
 }  // namespace converter
diff --git a/src/iidm/converter/xml/TerminalRefXml.cpp b/src/iidm/converter/xml/TerminalRefXml.cpp
index c8777a17..59bf0141 100644
--- a/src/iidm/converter/xml/TerminalRefXml.cpp
+++ b/src/iidm/converter/xml/TerminalRefXml.cpp
@@ -9,6 +9,7 @@
 
 #include <powsybl/AssertionError.hpp>
 #include <powsybl/iidm/Branch.hpp>
+#include <powsybl/iidm/BusbarSection.hpp>
 #include <powsybl/iidm/Enum.hpp>
 #include <powsybl/iidm/Network.hpp>
 #include <powsybl/iidm/PhaseTapChanger.hpp>
@@ -18,6 +19,7 @@
 #include <powsybl/iidm/converter/Anonymizer.hpp>
 #include <powsybl/iidm/converter/Constants.hpp>
 #include <powsybl/iidm/converter/xml/NetworkXmlWriterContext.hpp>
+#include <powsybl/stdcxx/instanceof.hpp>
 #include <powsybl/xml/XmlStreamWriter.hpp>
 
 namespace powsybl {
@@ -57,22 +59,40 @@ void TerminalRefXml::writeTerminalRef(const Terminal& terminal, NetworkXmlWriter
     if (!context.getFilter().test(c)) {
         throw PowsyblException(stdcxx::format("Oups, terminal ref point to a filtered equipment %1%", c.get().getId()));
     }
+    if (terminal.getVoltageLevel().getTopologyKind() == TopologyKind::NODE_BREAKER &&
+            context.getOptions().getTopologyLevel() != TopologyLevel::NODE_BREAKER &&
+            stdcxx::isInstanceOf<BusbarSection>(terminal.getConnectable())) {
+        throw PowsyblException(stdcxx::format("Terminal ref should not point to a busbar section (here %1%). Try to export in node-breaker or delete this terminal ref.", terminal.getConnectable().get().getId()));
+    }
     writer.writeStartElement(nsPrefix, elementName);
-    writer.writeAttribute(ID, context.getAnonymizer().anonymizeString(c.get().getId()));
+    writeTerminalRefAttribute(terminal, context);
+    writer.writeEndElement();
+}
+
+void TerminalRefXml::writeTerminalRefAttribute(const Terminal& terminal, NetworkXmlWriterContext& context) {
+    const auto& c = terminal.getConnectable();
+    if (!context.getFilter().test(c)) {
+        throw PowsyblException(stdcxx::format("Oups, terminal ref point to a filtered equipment %1%", c.get().getId()));
+    }
+    if (terminal.getVoltageLevel().getTopologyKind() == TopologyKind::NODE_BREAKER &&
+        context.getOptions().getTopologyLevel() != TopologyLevel::NODE_BREAKER &&
+        stdcxx::isInstanceOf<BusbarSection>(terminal.getConnectable())) {
+        throw PowsyblException(stdcxx::format("Terminal ref should not point to a busbar section (here %1%). Try to export in node-breaker or delete this terminal ref.", terminal.getConnectable().get().getId()));
+    }
+    context.getWriter().writeAttribute(ID, context.getAnonymizer().anonymizeString(c.get().getId()));
     if (c.get().getTerminals().size() > 1) {
         if (stdcxx::isInstanceOf<Injection>(c.get())) {
             // nothing to do
         } else if (stdcxx::isInstanceOf<Branch>(c.get())) {
             const auto& branch = dynamic_cast<const Branch&>(c.get());
-            writer.writeAttribute(SIDE, Enum::toString(branch.getSide(terminal)));
+            context.getWriter().writeAttribute(SIDE, Enum::toString(branch.getSide(terminal)));
         } else if (stdcxx::isInstanceOf<ThreeWindingsTransformer>(c.get())) {
             const auto& twt = dynamic_cast<const ThreeWindingsTransformer&>(c.get());
-            writer.writeAttribute(SIDE, Enum::toString(twt.getSide(terminal)));
+            context.getWriter().writeAttribute(SIDE, Enum::toString(twt.getSide(terminal)));
         } else {
             throw AssertionError(stdcxx::format("Unexpected Connectable instance: %1%", stdcxx::demangle(c.get())));
         }
     }
-    writer.writeEndElement();
 }
 
 }  // namespace xml
diff --git a/src/iidm/extensions/LoadDetailXmlSerializer.cpp b/src/iidm/extensions/LoadDetailXmlSerializer.cpp
index 80338e8d..72cac177 100644
--- a/src/iidm/extensions/LoadDetailXmlSerializer.cpp
+++ b/src/iidm/extensions/LoadDetailXmlSerializer.cpp
@@ -59,10 +59,10 @@ Extension& LoadDetailXmlSerializer::read(Extendable& extendable, converter::xml:
 
 void LoadDetailXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
     const auto& detail = safeCast<iidm::extensions::LoadDetail>(extension);
-    context.getExtensionsWriter().writeAttribute("fixedActivePower", detail.getFixedActivePower());
-    context.getExtensionsWriter().writeAttribute("fixedReactivePower", detail.getFixedReactivePower());
-    context.getExtensionsWriter().writeAttribute("variableActivePower", detail.getVariableActivePower());
-    context.getExtensionsWriter().writeAttribute("variableReactivePower", detail.getVariableReactivePower());
+    context.getWriter().writeAttribute("fixedActivePower", detail.getFixedActivePower());
+    context.getWriter().writeAttribute("fixedReactivePower", detail.getFixedReactivePower());
+    context.getWriter().writeAttribute("variableActivePower", detail.getVariableActivePower());
+    context.getWriter().writeAttribute("variableReactivePower", detail.getVariableReactivePower());
 }
 
 }  // namespace extensions
diff --git a/src/iidm/extensions/SlackTerminalXmlSerializer.cpp b/src/iidm/extensions/SlackTerminalXmlSerializer.cpp
new file mode 100644
index 00000000..80727748
--- /dev/null
+++ b/src/iidm/extensions/SlackTerminalXmlSerializer.cpp
@@ -0,0 +1,76 @@
+/**
+ * Copyright (c) 2021, RTE (http://www.rte-france.com)
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.
+ */
+
+#include "SlackTerminalXmlSerializer.hpp"
+
+#include <powsybl/iidm/VoltageLevel.hpp>
+#include <powsybl/iidm/converter/Anonymizer.hpp>
+#include <powsybl/iidm/converter/Constants.hpp>
+#include <powsybl/iidm/converter/xml/IidmXmlVersion.hpp>
+#include <powsybl/iidm/converter/xml/NetworkXmlReaderContext.hpp>
+#include <powsybl/iidm/converter/xml/NetworkXmlWriterContext.hpp>
+#include <powsybl/iidm/converter/xml/TerminalRefXml.hpp>
+#include <powsybl/iidm/converter/xml/VersionsCompatibity.hpp>
+#include <powsybl/iidm/extensions/SlackTerminal.hpp>
+#include <powsybl/iidm/extensions/SlackTerminalAdder.hpp>
+#include <powsybl/stdcxx/map.hpp>
+#include <powsybl/xml/XmlStreamReader.hpp>
+#include <powsybl/xml/XmlStreamWriter.hpp>
+
+namespace powsybl {
+
+namespace iidm {
+
+namespace extensions {
+
+SlackTerminalXmlSerializer::SlackTerminalXmlSerializer() :
+    AbstractVersionableExtensionXmlSerializer("slackTerminal", "network", "slt",
+          converter::xml::VersionsCompatibilityBuilder()
+              .put(converter::xml::IidmXmlVersion::V1_3(), {"1.0"})
+              .put(converter::xml::IidmXmlVersion::V1_4(), {"1.1"})
+              .put(converter::xml::IidmXmlVersion::V1_5(), {"1.2"})
+              .build(),
+          stdcxx::MapBuilder<std::string, std::string>()
+              .put("1.0", "http://www.powsybl.org/schema/iidm/ext/slack_terminal/1_0")
+              .put("1.1", "http://www.powsybl.org/schema/iidm/ext/slack_terminal/1_1")
+              .put("1.2", "http://www.powsybl.org/schema/iidm/ext/slack_terminal/1_2")
+              .build()) {
+}
+
+bool SlackTerminalXmlSerializer::isSerializable(const Extension& extension) const {
+    if (stdcxx::isInstanceOf<iidm::extensions::SlackTerminal>(extension)) {
+        const auto& slackTerminal = dynamic_cast<const iidm::extensions::SlackTerminal&>(extension);
+        return slackTerminal.getTerminal();
+    }
+    return false;
+}
+
+Extension& SlackTerminalXmlSerializer::read(Extendable& extendable, converter::xml::NetworkXmlReaderContext& context) const {
+    if (!stdcxx::isInstanceOf<VoltageLevel>(extendable)) {
+        throw AssertionError(stdcxx::format("Unexpected extendable type: %1% (%2% expected)", stdcxx::demangle(extendable), stdcxx::demangle<Terminal>()));
+    }
+    auto& voltageLevel = dynamic_cast<VoltageLevel&>(extendable);
+    const std::string& id = context.getAnonymizer().deanonymizeString(context.getReader().getAttributeValue(converter::ID));
+    const std::string& side = context.getReader().getOptionalAttributeValue(converter::SIDE, "");
+    Terminal& terminal = converter::xml::TerminalRefXml::readTerminalRef(voltageLevel.getNetwork(), id, side);
+    extendable.newExtension<SlackTerminalAdder>().withTerminal(terminal).add();
+    return extendable.getExtension<iidm::extensions::SlackTerminal>();
+}
+
+void SlackTerminalXmlSerializer::write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const {
+    const auto& slackTerminal = safeCast<iidm::extensions::SlackTerminal>(extension);
+    const auto& terminal = slackTerminal.getTerminal();
+    if (terminal) {
+        converter::xml::TerminalRefXml::writeTerminalRefAttribute(slackTerminal.getTerminal().get(), context);
+    }
+}
+
+}  // namespace extensions
+
+}  // namespace iidm
+
+}  // namespace powsybl
diff --git a/src/iidm/extensions/SlackTerminalXmlSerializer.hpp b/src/iidm/extensions/SlackTerminalXmlSerializer.hpp
new file mode 100644
index 00000000..33507821
--- /dev/null
+++ b/src/iidm/extensions/SlackTerminalXmlSerializer.hpp
@@ -0,0 +1,39 @@
+/**
+ * Copyright (c) 2021, RTE (http://www.rte-france.com)
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.
+ */
+
+#ifndef POWSYBL_IIDM_EXTENSIONS_SLACKTERMINALXMLSERIALIZER_HPP
+#define POWSYBL_IIDM_EXTENSIONS_SLACKTERMINALXMLSERIALIZER_HPP
+
+#include <powsybl/iidm/converter/xml/AbstractVersionableExtensionXmlSerializer.hpp>
+
+namespace powsybl {
+
+namespace iidm {
+
+namespace extensions {
+
+class SlackTerminalXmlSerializer : public converter::xml::AbstractVersionableExtensionXmlSerializer {
+public:  // ExtensionXmlSerializer
+    bool isSerializable(const Extension& extension) const override;
+
+    Extension& read(Extendable& extendable, converter::xml::NetworkXmlReaderContext& context) const override;
+
+    void write(const Extension& extension, converter::xml::NetworkXmlWriterContext& context) const override;
+
+public:
+    SlackTerminalXmlSerializer();
+
+    ~SlackTerminalXmlSerializer() noexcept override = default;
+};
+
+}  // namespace extensions
+
+}  // namespace iidm
+
+}  // namespace powsybl
+
+#endif  // POWSYBL_IIDM_EXTENSIONS_SLACKTERMINALXMLSERIALIZER_HPP
diff --git a/src/xml/XmlStreamWriter.cpp b/src/xml/XmlStreamWriter.cpp
index 17e2b549..9f80944b 100644
--- a/src/xml/XmlStreamWriter.cpp
+++ b/src/xml/XmlStreamWriter.cpp
@@ -82,10 +82,9 @@ void XmlStreamWriter::writeEmptyElement(const std::string& uri, const std::strin
 }
 
 void XmlStreamWriter::writeEndDocument() {
-    int written = xmlTextWriterEndDocument(m_writer.get());
-    if (written < 0) {
-        throw XmlStreamException("Failed to write end document");
-    }
+    // deleting the xmlTextWriter pointer automatically calls xmlTextWriterFlush() and write to stream
+    // m_writer is instanciated in writeStartElement, so it must be deleted here
+    m_writer.reset();
 }
 
 void XmlStreamWriter::writeEndElement() {
@@ -150,11 +149,9 @@ void XmlStreamWriter::writeStartDocument(const std::string& encoding, const std:
     auto writeCallback = [](void* context, const char* buffer, int len) {
         XmlStreamWriter& writer = *static_cast<XmlStreamWriter*>(context);
 
-        size_t beforeWrite = writer.m_stream.tellp();
         writer.m_stream.write(buffer, len);
-        size_t afterWrite = writer.m_stream.tellp();
 
-        return static_cast<int>(afterWrite - beforeWrite);
+        return len;
     };
 
     auto closeCallback = [](void* /*context*/) {
diff --git a/test/iidm/NodeBreakerVoltageLevelTest.cpp b/test/iidm/NodeBreakerVoltageLevelTest.cpp
index 5b57adcf..1f848dfe 100644
--- a/test/iidm/NodeBreakerVoltageLevelTest.cpp
+++ b/test/iidm/NodeBreakerVoltageLevelTest.cpp
@@ -19,8 +19,10 @@
 #include <powsybl/iidm/Network.hpp>
 #include <powsybl/iidm/Substation.hpp>
 #include <powsybl/iidm/Switch.hpp>
+#include <powsybl/iidm/TwoWindingsTransformer.hpp>
 #include <powsybl/iidm/VoltageLevel.hpp>
 #include <powsybl/iidm/VoltageLevelAdder.hpp>
+#include <powsybl/network/FourSubstationsNodeBreakerFactory.hpp>
 
 #include <powsybl/test/AssertionUtils.hpp>
 
@@ -1186,6 +1188,62 @@ BOOST_AUTO_TEST_CASE(TestRemoveVoltageLevelWithInternalConnectionsIssue) {
     POWSYBL_ASSERT_THROW(network.getVoltageLevel("S5 10kV"), PowsyblException, "Unable to find to the identifiable 'S5 10kV'");
 }
 
+BOOST_AUTO_TEST_CASE(issue318_invalidateCache) {
+    Network network("test", "test");
+    Substation& substation = network.newSubstation()
+        .setId("S1")
+        .setCountry(Country::FR)
+        .setTso("TSO")
+        .add();
+    VoltageLevel& vl1 = substation.newVoltageLevel()
+        .setId("VL1")
+        .setTopologyKind(TopologyKind::NODE_BREAKER)
+        .setNominalV(90.0)
+        .setLowVoltageLimit(88.0)
+        .setHighVoltageLimit(96.0)
+        .add();
+
+    BusbarSection& bbs1 = vl1.getNodeBreakerView().newBusbarSection()
+        .setId("BBS1")
+        .setName("BBS1_NAME")
+        .setNode(0)
+        .add();
+
+    // In that case, the bus cache is initialized, but there is no bus for node 0
+    BOOST_CHECK(!bbs1.getTerminal().getBusView().getBus());
+
+    BusbarSection& bbs2 = vl1.getNodeBreakerView().newBusbarSection()
+        .setId("BBS2")
+        .setName("BBS2_NAME")
+        .setNode(1)
+        .add();
+
+    // Without the fix, this call throws an exception (ArrayIndexOutOfBoundsException), but an invalid reference is expected
+    BOOST_CHECK(!bbs2.getTerminal().getBusView().getBus());
+}
+
+BOOST_AUTO_TEST_CASE(NbkComprehensiveErrorMessage) {
+    Network network = powsybl::network::FourSubstationsNodeBreakerFactory::create();
+    BusbarSection& busbarSection = network.getBusbarSection("S1VL2_BBS1");
+    TwoWindingsTransformer& twt = network.getTwoWindingsTransformer("TWT");
+    twt.getPhaseTapChanger().setRegulationTerminal(stdcxx::ref(busbarSection.getTerminal()));
+
+    stdcxx::Properties properties;
+    properties.set(converter::ExportOptions::TOPOLOGY_LEVEL, "NODE_BREAKER");
+
+    std::stringstream ss;
+
+    // make sure no error is thrown while exporting to NODE_BREAKER topology
+    BOOST_CHECK_NO_THROW({
+         Network::writeXml("network.xiidm", ss, network, converter::ExportOptions(properties));
+         Network::readXml("network.xiidm", ss);
+    });
+
+    // make sure an error is thrown when exporting to BUS_BREAKER topology (see #295)
+    properties.set(converter::ExportOptions::TOPOLOGY_LEVEL, "BUS_BREAKER");
+    POWSYBL_ASSERT_THROW(Network::writeXml("network.xiidm", ss, network, converter::ExportOptions(properties)), PowsyblException, "Terminal ref should not point to a busbar section (here S1VL2_BBS1). Try to export in node-breaker or delete this terminal ref.");
+}
+
 BOOST_AUTO_TEST_SUITE_END()
 
 }  // namespace iidm
diff --git a/test/iidm/converter/xml/CMakeLists.txt b/test/iidm/converter/xml/CMakeLists.txt
index 9e7d3289..603ab31d 100644
--- a/test/iidm/converter/xml/CMakeLists.txt
+++ b/test/iidm/converter/xml/CMakeLists.txt
@@ -22,6 +22,7 @@ set(EXT_SOURCES
 set(UNIT_TEST_SOURCES
     BatteryRoundTripTest.cpp
     EurostagTest.cpp
+    ExtensionProvidersTest.cpp
     FictitiousSwitchTest.cpp
     FourSubstationsNodeBreakerTest.cpp
     HvdcRoundTripTest.cpp
diff --git a/test/iidm/converter/xml/ExtensionProvidersTest.cpp b/test/iidm/converter/xml/ExtensionProvidersTest.cpp
new file mode 100644
index 00000000..26b059e2
--- /dev/null
+++ b/test/iidm/converter/xml/ExtensionProvidersTest.cpp
@@ -0,0 +1,43 @@
+/**
+ * Copyright (c) 2021, RTE (http://www.rte-france.com)
+ * This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/.
+ */
+
+#include <boost/test/unit_test.hpp>
+
+#include <powsybl/iidm/ExtensionProviders.hpp>
+#include <powsybl/iidm/converter/xml/ExtensionXmlSerializer.hpp>
+#include <powsybl/test/AssertionUtils.hpp>
+
+namespace powsybl {
+
+namespace iidm {
+
+namespace converter {
+
+namespace xml {
+
+BOOST_AUTO_TEST_SUITE(ExtensionProvidersTestSuite)
+
+BOOST_AUTO_TEST_CASE(findProvider) {
+    auto& extProvider = ExtensionProviders<converter::xml::ExtensionXmlSerializer>::getInstance();
+    BOOST_CHECK(!extProvider.findProvider("test"));
+    POWSYBL_ASSERT_THROW(extProvider.findProviderOrThrowException("test"), PowsyblException, "No provider found for extension 'test'");
+
+    BOOST_CHECK(extProvider.findProvider("loadBar"));
+    BOOST_CHECK_NO_THROW(extProvider.findProviderOrThrowException("loadBar"));
+
+    BOOST_CHECK_EQUAL(7, boost::size(extProvider.getProviders()));
+}
+
+BOOST_AUTO_TEST_SUITE_END()
+
+}  // namespace xml
+
+}  // namespace converter
+
+}  // namespace iidm
+
+}  // namespace powsybl
diff --git a/test/iidm/converter/xml/IdentifiableExtensionXmlSerializerTest.cpp b/test/iidm/converter/xml/IdentifiableExtensionXmlSerializerTest.cpp
index cd9c625e..569fadbe 100644
--- a/test/iidm/converter/xml/IdentifiableExtensionXmlSerializerTest.cpp
+++ b/test/iidm/converter/xml/IdentifiableExtensionXmlSerializerTest.cpp
@@ -33,7 +33,7 @@ BOOST_AUTO_TEST_SUITE(IdentifiableExtensionXml)
 BOOST_AUTO_TEST_CASE(ExtensionXmlSerializerTest) {
     // Number of extensions provided by powsybl-iidm4cpp without any extension library
     // - LoadDetail
-    const unsigned int DEFAULT_EXTENSION_COUNT = 1;
+    const unsigned int DEFAULT_EXTENSION_COUNT = 2;
 
     auto& providers = ExtensionProviders<ExtensionXmlSerializer>::getInstance();
     const auto& cProviders = providers;
diff --git a/test/iidm/converter/xml/extensions/TerminalMockXmlSerializer.cpp b/test/iidm/converter/xml/extensions/TerminalMockXmlSerializer.cpp
index b855ea12..b2e65a0c 100644
--- a/test/iidm/converter/xml/extensions/TerminalMockXmlSerializer.cpp
+++ b/test/iidm/converter/xml/extensions/TerminalMockXmlSerializer.cpp
@@ -38,6 +38,7 @@ TerminalMockXmlSerializer::TerminalMockXmlSerializer() :
             .put(IidmXmlVersion::V1_2(), {"1.2"})
             .put(IidmXmlVersion::V1_3(), {"1.3"})
             .put(IidmXmlVersion::V1_4(), {"1.4"})
+            .put(IidmXmlVersion::V1_5(), {"1.5"})
             .build(),
         stdcxx::MapBuilder<std::string, std::string>()
             .put("1.0", "http://www.itesla_project.eu/schema/iidm/ext/terminal_mock/1_0")
@@ -45,6 +46,7 @@ TerminalMockXmlSerializer::TerminalMockXmlSerializer() :
             .put("1.2", "http://www.powsybl.org/schema/iidm/ext/terminal_mock/1_2")
             .put("1.3", "http://www.powsybl.org/schema/iidm/ext/terminal_mock/1_3")
             .put("1.4", "http://www.powsybl.org/schema/iidm/ext/terminal_mock/1_4")
+            .put("1.5", "http://www.powsybl.org/schema/iidm/ext/terminal_mock/1_5")
             .build()) {
 }
 
@@ -74,7 +76,7 @@ Extension& TerminalMockXmlSerializer::read(Extendable& extendable, NetworkXmlRea
 
 void TerminalMockXmlSerializer::write(const Extension& extension, NetworkXmlWriterContext& context) const {
     const auto& terminalMockExt = safeCast<TerminalMockExt>(extension);
-    TerminalRefXml::writeTerminalRef(terminalMockExt.getTerminal(), context, getNamespacePrefix(), "terminal", context.getExtensionsWriter());
+    TerminalRefXml::writeTerminalRef(terminalMockExt.getTerminal(), context, getNamespacePrefix(), "terminal", context.getWriter());
 }
 
 }  // namespace extensions
diff --git a/test/iidm/extensions/SlackTerminalTest.cpp b/test/iidm/extensions/SlackTerminalTest.cpp
index c8372eb9..565bc5b6 100644
--- a/test/iidm/extensions/SlackTerminalTest.cpp
+++ b/test/iidm/extensions/SlackTerminalTest.cpp
@@ -20,8 +20,9 @@
 #include <powsybl/iidm/extensions/SlackTerminalAdder.hpp>
 #include <powsybl/network/EurostagFactory.hpp>
 #include <powsybl/stdcxx/DateTime.hpp>
-
 #include <powsybl/test/AssertionUtils.hpp>
+#include <powsybl/test/ResourceFixture.hpp>
+#include <powsybl/test/converter/RoundTrip.hpp>
 
 namespace powsybl {
 
@@ -242,6 +243,20 @@ BOOST_AUTO_TEST_CASE(variantsResetTest) {
     POWSYBL_ASSERT_THROW(vlhv1.getExtension<SlackTerminal>(), PowsyblException, "Extension powsybl::iidm::extensions::SlackTerminal not found");
 }
 
+BOOST_FIXTURE_TEST_CASE(SlackTerminalXmlSerializerTest, test::ResourceFixture) {
+    Network network = powsybl::network::EurostagFactory::createTutorial1Network();
+    network.setCaseDate(stdcxx::DateTime::parse("2019-05-27T12:17:02.504+02:00"));
+    VoltageLevel& voltageLevel = network.getVoltageLevel("VLHV2");
+    Bus& bus = network.getBusBreakerView().getBus("NHV2");
+    Terminal& terminal = *bus.getConnectedTerminals().begin();
+
+    voltageLevel.newExtension<SlackTerminalAdder>().withTerminal(terminal).add();
+
+    const std::string& networkStr = test::converter::RoundTrip::getVersionedNetwork("slackTerminal.xml", converter::xml::IidmXmlVersion::CURRENT_IIDM_XML_VERSION());
+
+    test::converter::RoundTrip::runXml(network, networkStr);
+}
+
 BOOST_AUTO_TEST_SUITE_END()
 
 }  // namespace extensions
diff --git a/test/resources/V1_5/LccRoundTripRef.xml b/test/resources/V1_5/LccRoundTripRef.xml
new file mode 100644
index 00000000..8242bcd5
--- /dev/null
+++ b/test/resources/V1_5/LccRoundTripRef.xml
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="hvdctest" caseDate="2016-06-27T16:34:55.930000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="400" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1"/>
+            </iidm:busBreakerTopology>
+            <iidm:shunt id="C1_Filter1" name="Filter 1" sectionCount="1" voltageRegulatorOn="false" bus="B1" connectableBus="B1" q="25">
+                <iidm:shuntLinearModel bPerSection="1.0000000000000001e-05" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:shunt id="C1_Filter2" name="Filter 2" sectionCount="0" voltageRegulatorOn="false" connectableBus="B1" q="25">
+                <iidm:shuntLinearModel bPerSection="2.0000000000000002e-05" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:lccConverterStation id="C1" name="Converter1" lossFactor="1.1000000000000001" powerFactor="0.5" bus="B1" connectableBus="B1" p="100" q="50"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="400" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="BBS1" name="BusbarSection" node="0"/>
+                <iidm:switch id="DISC_BBS1_BK1" name="Disconnector" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="BK1" name="Breaker" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+                <iidm:switch id="DISC_BBS1_BK2" name="Disconnector" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="3"/>
+                <iidm:switch id="BK2" name="Breaker" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:switch id="DISC_BBS1_BK3" name="Disconnector" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="5"/>
+                <iidm:switch id="BK3" name="Breaker" kind="BREAKER" retained="true" open="false" node1="5" node2="6"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:shunt id="C2_Filter1" name="Filter 3" sectionCount="1" voltageRegulatorOn="false" node="4" q="12.5">
+                <iidm:shuntLinearModel bPerSection="3.0000000000000001e-05" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:shunt id="C2_Filter2" name="Filter 4" sectionCount="1" voltageRegulatorOn="false" node="6" q="12.5">
+                <iidm:shuntLinearModel bPerSection="4.0000000000000003e-05" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:lccConverterStation id="C2" name="Converter2" lossFactor="1.1000000000000001" powerFactor="0.59999999999999998" node="2" p="75" q="25"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:hvdcLine id="L" name="HVDC" r="1" nominalV="400" convertersMode="SIDE_1_INVERTER_SIDE_2_RECTIFIER" activePowerSetpoint="280" maxP="300" converterStation1="C1" converterStation2="C2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/VscRoundTripRef.xml b/test/resources/V1_5/VscRoundTripRef.xml
new file mode 100644
index 00000000..d2fca89d
--- /dev/null
+++ b/test/resources/V1_5/VscRoundTripRef.xml
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="hvdctest" caseDate="2016-06-27T16:34:55.930000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="400" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1"/>
+            </iidm:busBreakerTopology>
+            <iidm:vscConverterStation id="C1" name="Converter1" voltageRegulatorOn="true" lossFactor="1.1000000000000001" voltageSetpoint="405" bus="B1" connectableBus="B1" p="100" q="50">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="5" minQ="0" maxQ="10"/>
+                    <iidm:point p="10" minQ="0" maxQ="10"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:vscConverterStation>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="400" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="BBS1" name="BusbarSection" node="0"/>
+                <iidm:switch id="DISC_BBS1_BK1" name="Disconnector" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="BK1" name="Breaker" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:vscConverterStation id="C2" name="Converter2" voltageRegulatorOn="false" lossFactor="1.1000000000000001" reactivePowerSetpoint="123" node="2">
+                <iidm:minMaxReactiveLimits minQ="0" maxQ="10"/>
+            </iidm:vscConverterStation>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:hvdcLine id="L" name="HVDC" r="1" nominalV="400" convertersMode="SIDE_1_INVERTER_SIDE_2_RECTIFIER" activePowerSetpoint="280" maxP="300" converterStation1="C1" converterStation2="C2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/batteryRoundTripRef.xml b/test/resources/V1_5/batteryRoundTripRef.xml
new file mode 100644
index 00000000..6abe91fe
--- /dev/null
+++ b/test/resources/V1_5/batteryRoundTripRef.xml
@@ -0,0 +1,32 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="fictitious" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="R" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="400" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN" p="-605" q="-225">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="R" geographicalTags="B">
+        <iidm:voltageLevel id="VLBAT" nominalV="400" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NBAT"/>
+            </iidm:busBreakerTopology>
+            <iidm:battery id="BAT" p0="9999.9899999999998" q0="9999.9899999999998" minP="-9999.9899999999998" maxP="9999.9899999999998" bus="NBAT" connectableBus="NBAT" p="-605" q="-225">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:battery>
+            <iidm:battery id="BAT2" p0="100" q0="200" minP="-200" maxP="200" bus="NBAT" connectableBus="NBAT" p="-605" q="-225">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-59.299999999999997" maxQ="60"/>
+                    <iidm:point p="70" minQ="-54.549999999999997" maxQ="46.25"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:battery>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NBAT" connectableBus="NBAT"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NBAT" connectableBus2="NBAT" voltageLevelId2="VLBAT"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NBAT" connectableBus2="NBAT" voltageLevelId2="VLBAT"/>
+</iidm:network>
diff --git a/test/resources/V1_5/completeThreeWindingsTransformerRoundTripRef.xml b/test/resources/V1_5/completeThreeWindingsTransformerRoundTripRef.xml
new file mode 100644
index 00000000..3ee8c07e
--- /dev/null
+++ b/test/resources/V1_5/completeThreeWindingsTransformerRoundTripRef.xml
@@ -0,0 +1,66 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="three-windings-transformer" caseDate="2018-03-05T13:30:30.486000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="SUBSTATION" country="FR">
+        <iidm:voltageLevel id="VL_132" nominalV="132" lowVoltageLimit="118.8" highVoltageLimit="145.19999999999999" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_132" v="133.584" angle="-9.6199999999999992"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN_132" energySource="OTHER" minP="0" maxP="140" voltageRegulatorOn="true" targetP="7.2000000000000002" targetV="135" bus="BUS_132" connectableBus="BUS_132">
+                <iidm:minMaxReactiveLimits minQ="-1.7976931348623157e+308" maxQ="1.7976931348623157e+308"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL_33" nominalV="33" lowVoltageLimit="29.699999999999999" highVoltageLimit="36.299999999999997" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_33" v="34.881" angle="-15.24"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_33" loadType="UNDEFINED" p0="11.199999999999999" q0="7.5" bus="BUS_33" connectableBus="BUS_33" p="11.199999999999999" q="7.5"/>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL_11" nominalV="11" lowVoltageLimit="9.9000000000000004" highVoltageLimit="12.1" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_11" v="11.781000000000001" angle="-15.24"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_11" loadType="UNDEFINED" p0="0" q0="-10.6" bus="BUS_11" connectableBus="BUS_11" p="0" q="-10.6"/>
+        </iidm:voltageLevel>
+        <iidm:threeWindingsTransformer id="3WT" r1="17.423999999999999" x1="1.7423999999999999" g1="0.0057392102846648297" b1="0.00057392102846648299" ratedU1="132" ratedS1="1" r2="1.089" x2="0.1089" g2="0" b2="0" ratedU2="33" ratedS2="2" r3="0.121" x3="0.0121" g3="0" b3="0" ratedU3="11" ratedS3="3" ratedU0="132" bus1="BUS_132" connectableBus1="BUS_132" voltageLevelId1="VL_132" bus2="BUS_33" connectableBus2="BUS_33" voltageLevelId2="VL_33" bus3="BUS_11" connectableBus3="BUS_11" voltageLevelId3="VL_11">
+            <iidm:ratioTapChanger1 lowTapPosition="0" tapPosition="0" targetDeadband="0" loadTapChangingCapabilities="false">
+                <iidm:step r="1.089" x="0.1089" g="0.091827364554637275" b="0.0091827364554637279" rho="1"/>
+            </iidm:ratioTapChanger1>
+            <iidm:phaseTapChanger1 lowTapPosition="1" tapPosition="2" regulationMode="FIXED_TAP">
+                <iidm:step r="0.10000000149011612" x="0.10000000149011612" g="0.10000000149011612" b="0.10000000149011612" rho="1" alpha="-50"/>
+                <iidm:step r="0.10000000149011612" x="0.10000000149011612" g="0.10000000149011612" b="0.10000000149011612" rho="1" alpha="-25"/>
+            </iidm:phaseTapChanger1>
+            <iidm:ratioTapChanger2 lowTapPosition="0" tapPosition="2" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="33">
+                <iidm:terminalRef id="LOAD_33"/>
+                <iidm:step r="0.98009999999999997" x="0.09801" g="0.082644628099173556" b="0.0082644628099173556" rho="0.90000000000000002"/>
+                <iidm:step r="1.089" x="0.1089" g="0.091827364554637275" b="0.0091827364554637279" rho="1"/>
+                <iidm:step r="1.1979" x="0.11978999999999999" g="0.10101010101010101" b="0.0101010101010101" rho="1.1000000000000001"/>
+            </iidm:ratioTapChanger2>
+            <iidm:phaseTapChanger2 lowTapPosition="1" tapPosition="2" regulationMode="FIXED_TAP">
+                <iidm:step r="0.10000000149011612" x="0.10000000149011612" g="0.10000000149011612" b="0.10000000149011612" rho="1" alpha="-50"/>
+                <iidm:step r="0.10000000149011612" x="0.10000000149011612" g="0.10000000149011612" b="0.10000000149011612" rho="1" alpha="-25"/>
+            </iidm:phaseTapChanger2>
+            <iidm:ratioTapChanger3 lowTapPosition="0" tapPosition="0" targetDeadband="0" loadTapChangingCapabilities="true" regulating="false" targetV="11">
+                <iidm:terminalRef id="LOAD_11"/>
+                <iidm:step r="0.1089" x="0.01089" g="0.82644628099173556" b="0.082644628099173556" rho="0.90000000000000002"/>
+                <iidm:step r="0.121" x="0.0121" g="0.82644628099173556" b="0.082644628099173556" rho="1"/>
+                <iidm:step r="0.1331" x="0.013310000000000001" g="0.90909090909090917" b="0.090909090909090925" rho="1.1000000000000001"/>
+            </iidm:ratioTapChanger3>
+            <iidm:phaseTapChanger3 lowTapPosition="1" tapPosition="2" regulationMode="FIXED_TAP">
+                <iidm:step r="0.10000000149011612" x="0.10000000149011612" g="0.10000000149011612" b="0.10000000149011612" rho="1" alpha="-50"/>
+                <iidm:step r="0.10000000149011612" x="0.10000000149011612" g="0.10000000149011612" b="0.10000000149011612" rho="1" alpha="-25"/>
+            </iidm:phaseTapChanger3>
+            <iidm:currentLimits1 permanentLimit="1000">
+                <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="1200"/>
+                <iidm:temporaryLimit name="10'" acceptableDuration="600" value="1400"/>
+            </iidm:currentLimits1>
+            <iidm:currentLimits2 permanentLimit="100">
+                <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="120"/>
+                <iidm:temporaryLimit name="10'" acceptableDuration="600" value="140"/>
+            </iidm:currentLimits2>
+            <iidm:currentLimits3 permanentLimit="10">
+                <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="12"/>
+                <iidm:temporaryLimit name="10'" acceptableDuration="600" value="14"/>
+            </iidm:currentLimits3>
+        </iidm:threeWindingsTransformer>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/danglingLine.xml b/test/resources/V1_5/danglingLine.xml
new file mode 100644
index 00000000..89490b29
--- /dev/null
+++ b/test/resources/V1_5/danglingLine.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2" v="389.95267639160159" angle="-3.5063576698303223"/>
+            </iidm:busBreakerTopology>
+            <iidm:danglingLine id="NHV1_NHV2_1" p0="-300.43389892578125" q0="-137.18849182128906" r="1.5" x="16.5" g="0" b="0.000193" bus="NHV2" connectableBus="NHV2" p="-300.43389892578125" q="-137.18849182128906"/>
+            <iidm:danglingLine id="NHV1_NHV2_2" p0="-300.43389892578125" q0="-137.18849182128906" r="1.5" x="16.5" g="0" b="0.000193" bus="NHV2" connectableBus="NHV2" p="-300.43389892578125" q="-137.18849182128906"/>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD" v="147.57861328125" angle="-9.6144866943359375"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD" p="600" q="200"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD" p1="600.8677978515625" q1="274.37698364257" p2="-600" q2="-200">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/danglingLineWithGeneration.xml b/test/resources/V1_5/danglingLineWithGeneration.xml
new file mode 100644
index 00000000..6bc43ccd
--- /dev/null
+++ b/test/resources/V1_5/danglingLineWithGeneration.xml
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="dangling-line" caseDate="2020-07-16T10:08:48.321000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S" country="FR">
+        <iidm:voltageLevel id="VL" nominalV="100" lowVoltageLimit="80" highVoltageLimit="120" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="G" energySource="OTHER" minP="0" maxP="100" voltageRegulatorOn="true" targetP="50" targetV="100" targetQ="30" bus="BUS" connectableBus="BUS">
+                <iidm:minMaxReactiveLimits minQ="-1.7976931348623157e+308" maxQ="1.7976931348623157e+308"/>
+            </iidm:generator>
+            <iidm:danglingLine id="DL" p0="50" q0="30" r="10" x="1" g="0.0001" b="1.0000000000000001e-05" generationMinP="0" generationMaxP="900" generationVoltageRegulationOn="true" generationTargetP="440" generationTargetV="400" bus="BUS" connectableBus="BUS">
+                <iidm:property name="test" value="test"/>
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-59.299999999999997" maxQ="60"/>
+                    <iidm:point p="70" minQ="-54.549999999999997" maxQ="46.25"/>
+                </iidm:reactiveCapabilityCurve>
+                <iidm:currentLimits permanentLimit="100">
+                    <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="120"/>
+                    <iidm:temporaryLimit name="10'" acceptableDuration="600" value="140"/>
+                </iidm:currentLimits>
+            </iidm:danglingLine>
+        </iidm:voltageLevel>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-properties.xml b/test/resources/V1_5/eurostag-tutorial-example1-properties.xml
new file mode 100644
index 00000000..addb5a41
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-properties.xml
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:property name="prop1" value="value1"/>
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:property name="prop2" value="value2"/>
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:property name="prop3" value="value3"/>
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2">
+        <iidm:property name="prop4" value="value4"/>
+    </iidm:line>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-terminalMock.xml b/test/resources/V1_5/eurostag-tutorial-example1-terminalMock.xml
new file mode 100644
index 00000000..051a2a55
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-terminalMock.xml
@@ -0,0 +1,8 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:mock="http://www.powsybl.org/schema/iidm/ext/terminal_mock/1_5" id="sim1" caseDate="2013-01-15T18:45:00.000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:extension id="LOAD">
+        <mock:terminalMock>
+            <mock:terminal id="LOAD"/>
+        </mock:terminalMock>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-with-bad-loadMockExt.xml b/test/resources/V1_5/eurostag-tutorial-example1-with-bad-loadMockExt.xml
new file mode 100644
index 00000000..1f829d92
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-with-bad-loadMockExt.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:lmock="http://www.powsybl.org/schema/iidm/ext/load_mock/1_0" id="sim1" caseDate="2013-01-15T18:45:00.000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.99" maxP="9999.99" voltageRegulatorOn="true" targetP="607.0" targetV="24.5" targetQ="301.0" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.99" maxQ="9999.99"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0.0" b="0.0" ratedU1="24.0" ratedU2="400.0" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600.0" q0="200.0" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.04724999999999999" x="4.049724365620455" g="0.0" b="0.0" ratedU1="400.0" ratedU2="158.0" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" regulating="true" loadTapChangingCapabilities="true" targetV="158.0">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0.0" x="0.0" g="0.0" b="0.0" rho="0.8505666905244191"/>
+                <iidm:step r="0.0" x="0.0" g="0.0" b="0.0" rho="1.0006666666666666"/>
+                <iidm:step r="0.0" x="0.0" g="0.0" b="0.0" rho="1.150766642808914"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3.0" x="33.0" g1="0.0" b1="1.93E-4" g2="0.0" b2="1.93E-4" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3.0" x="33.0" g1="0.0" b1="1.93E-4" g2="0.0" b2="1.93E-4" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="LOAD">
+        <lmock:loadMock/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-with-bad-loadQuxExt.xml b/test/resources/V1_5/eurostag-tutorial-example1-with-bad-loadQuxExt.xml
new file mode 100644
index 00000000..9523d74c
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-with-bad-loadQuxExt.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:lq="http://www.powsybl.org/schema/iidm/ext/load_qux/1_0" id="sim1" caseDate="2013-01-15T18:45:00.000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.99" maxP="9999.99" voltageRegulatorOn="true" targetP="607.0" targetV="24.5" targetQ="301.0" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.99" maxQ="9999.99"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0.0" b="0.0" ratedU1="24.0" ratedU2="400.0" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150.0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600.0" q0="200.0" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.04724999999999999" x="4.049724365620455" g="0.0" b="0.0" ratedU1="400.0" ratedU2="158.0" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" regulating="true" loadTapChangingCapabilities="true" targetV="158.0">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0.0" x="0.0" g="0.0" b="0.0" rho="0.8505666905244191"/>
+                <iidm:step r="0.0" x="0.0" g="0.0" b="0.0" rho="1.0006666666666666"/>
+                <iidm:step r="0.0" x="0.0" g="0.0" b="0.0" rho="1.150766642808914"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3.0" x="33.0" g1="0.0" b1="1.93E-4" g2="0.0" b2="1.93E-4" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3.0" x="33.0" g1="0.0" b1="1.93E-4" g2="0.0" b2="1.93E-4" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="LOAD">
+        <lq:loadQux/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_1.xml b/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_1.xml
new file mode 100644
index 00000000..b95b529c
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_1.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:lmock="http://www.powsybl.org/schema/iidm/ext/load_mock/1_1" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="LOAD">
+        <lmock:loadMock/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_2.xml b/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_2.xml
new file mode 100644
index 00000000..099a2a0c
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_2.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:lmock="http://www.powsybl.org/schema/iidm/ext/load_mock/1_2" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="LOAD">
+        <lmock:loadMock/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_3.xml b/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_3.xml
new file mode 100644
index 00000000..5b41ab22
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-with-loadMockExt-1_3.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:lmock="http://www.powsybl.org/schema/iidm/ext/load_mock/1_3" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="LOAD">
+        <lmock:loadMock/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1-with-terminalMock-ext.xml b/test/resources/V1_5/eurostag-tutorial-example1-with-terminalMock-ext.xml
new file mode 100644
index 00000000..11f73ba3
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1-with-terminalMock-ext.xml
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:mock="http://www.powsybl.org/schema/iidm/ext/terminal_mock/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="LOAD">
+        <mock:terminalMock>
+            <mock:terminal id="LOAD"/>
+        </mock:terminalMock>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial-example1.xml b/test/resources/V1_5/eurostag-tutorial-example1.xml
new file mode 100644
index 00000000..7acc8b72
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial-example1.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/eurostag-tutorial1-lf.xml b/test/resources/V1_5/eurostag-tutorial1-lf.xml
new file mode 100644
index 00000000..6291f6f8
--- /dev/null
+++ b/test/resources/V1_5/eurostag-tutorial1-lf.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN" v="24.500000610351563" angle="2.3259763717651367"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN" p="-605.558349609375" q="-225.28251647949219">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1" v="402.14284515380859" angle="0"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1" p1="605.558349609375" q1="225.28251647949219" p2="-604.89093017578125" q2="-197.48046875"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2" v="389.95267639160159" angle="-3.5063576698303223"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD" v="147.57861328125" angle="-9.6144866943359375"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD" p="600" q="200"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD" p1="600.8677978515625" q1="274.37698364257" p2="-600" q2="-200">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906"/>
+</iidm:network>
diff --git a/test/resources/V1_5/fictitiousSwitchRef-bbk.xml b/test/resources/V1_5/fictitiousSwitchRef-bbk.xml
new file mode 100644
index 00000000..e520bf58
--- /dev/null
+++ b/test/resources/V1_5/fictitiousSwitchRef-bbk.xml
@@ -0,0 +1,92 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="fictitious" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="A" country="FR">
+        <iidm:voltageLevel id="C" nominalV="225" lowVoltageLimit="0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="C_0" v="234.40912" angle="0"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="N" nominalV="225" lowVoltageLimit="220" highVoltageLimit="245.00002000000001" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="N_0" v="236.44736" angle="15.250391"/>
+                <iidm:bus id="N_1" v="236.44736" angle="15.250391"/>
+                <iidm:bus id="N_11"/>
+                <iidm:bus id="N_13"/>
+                <iidm:bus id="N_2"/>
+                <iidm:bus id="N_3"/>
+                <iidm:bus id="N_12"/>
+                <iidm:bus id="N_14"/>
+                <iidm:switch id="BJ" name="BK" kind="BREAKER" retained="true" open="false" bus1="N_1" bus2="N_0"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="CD" energySource="HYDRO" minP="0" maxP="35" voltageRegulatorOn="true" targetP="21.789588999999999" targetV="236.44736" targetQ="-20.701546" bus="N_0" connectableBus="N_0" p="-21.789588999999999" q="20.693394000000001">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-20.600000000000001" maxQ="18.100000000000001"/>
+                    <iidm:point p="35" minQ="-21.725000000000001" maxQ="6.3500003999999999"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="CB" energySource="HYDRO" minP="0" maxP="70" voltageRegulatorOn="false" targetP="0" targetV="0" targetQ="0" bus="N_12" connectableBus="N_12">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-59.299999999999997" maxQ="60"/>
+                    <iidm:point p="70" minQ="-54.549999999999997" maxQ="46.25"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="CC" energySource="HYDRO" minP="0" maxP="80" voltageRegulatorOn="false" targetP="0" targetV="0" targetQ="0" bus="N_14" connectableBus="N_14">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-56.799999999999997" maxQ="57.399999999999999"/>
+                    <iidm:point p="80" minQ="-53.514000000000003" maxQ="36.399999999999999"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:load id="CF" loadType="UNDEFINED" p0="8.4558540000000004" q0="-23.695924999999999" bus="N_1" connectableBus="N_1" p="8.4558540000000004" q="-23.695924999999999"/>
+            <iidm:load id="CG" loadType="UNDEFINED" p0="90.399109999999993" q0="-51.968690000000002" bus="N_1" connectableBus="N_1" p="90.399109999999993" q="-51.968690000000002"/>
+            <iidm:load id="CH" loadType="UNDEFINED" p0="-5.1022489999999996" q0="4.9081216000000003" bus="N_1" connectableBus="N_1" p="-5.1022489999999996" q="4.9081216000000003"/>
+            <iidm:load id="CE" loadType="UNDEFINED" p0="-72.186890000000005" q0="50.168945000000001" bus="N_3" connectableBus="N_3" p="-72.186890000000005" q="50.168945000000001"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="CI" r="2" x="14.744999999999999" g="0" b="3.1999999999999999e-05" ratedU1="225" ratedU2="225" bus1="C_0" connectableBus1="C_0" voltageLevelId1="C" bus2="N_1" connectableBus2="N_1" voltageLevelId2="N">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="22" regulationMode="CURRENT_LIMITER" regulationValue="930.66669999999999" regulating="false">
+                <iidm:terminalRef id="CI" side="ONE"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="-42.799999999999997"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="-40.18"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="-37.539999999999999"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="-34.899999999999999"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="-32.259999999999998"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="-29.600000000000001"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="-26.940000000000001"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="-24.260000000000002"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="-21.579999999999998"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="-18.899999999999999"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="-16.219999999999999"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="-13.52"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="-10.82"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="-8.1199999999999992"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="-5.4199999999999999"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="-2.7000000000000002"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="0"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="2.7000000000000002"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="5.4199999999999999"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="8.1199999999999992"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="10.82"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="13.52"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="16.219999999999999"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="18.899999999999999"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="21.579999999999998"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="24.260000000000002"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="26.940000000000001"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="29.600000000000001"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="32.259999999999998"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="34.899999999999999"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="37.539999999999999"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="40.18"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="42.799999999999997"/>
+            </iidm:phaseTapChanger>
+            <iidm:currentLimits1 permanentLimit="931"/>
+            <iidm:currentLimits2 permanentLimit="931"/>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="CJ" r="0.0099999990000000007" x="0.10000002400000001" g1="0" b1="0" g2="0" b2="0" bus1="C_0" connectableBus1="C_0" voltageLevelId1="C" bus2="N_3" connectableBus2="N_3" voltageLevelId2="N">
+        <iidm:currentLimits1 permanentLimit="931"/>
+        <iidm:currentLimits2 permanentLimit="931">
+            <iidm:temporaryLimit name="IST" value="1640" fictitious="true"/>
+            <iidm:temporaryLimit name="IT1" acceptableDuration="60"/>
+        </iidm:currentLimits2>
+    </iidm:line>
+</iidm:network>
diff --git a/test/resources/V1_5/fictitiousSwitchRef-bbr.xml b/test/resources/V1_5/fictitiousSwitchRef-bbr.xml
new file mode 100644
index 00000000..58486e8a
--- /dev/null
+++ b/test/resources/V1_5/fictitiousSwitchRef-bbr.xml
@@ -0,0 +1,85 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="fictitious" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="A" country="FR">
+        <iidm:voltageLevel id="C" nominalV="225" lowVoltageLimit="0" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="C_0" v="234.40912" angle="0"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="N" nominalV="225" lowVoltageLimit="220" highVoltageLimit="245.00002000000001" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="N_0" v="236.44736" angle="15.250391"/>
+                <iidm:bus id="N_3"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="CB" energySource="HYDRO" minP="0" maxP="70" voltageRegulatorOn="false" targetP="0" targetV="0" targetQ="0" connectableBus="N_0">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-59.299999999999997" maxQ="60"/>
+                    <iidm:point p="70" minQ="-54.549999999999997" maxQ="46.25"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="CC" energySource="HYDRO" minP="0" maxP="80" voltageRegulatorOn="false" targetP="0" targetV="0" targetQ="0" connectableBus="N_0">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-56.799999999999997" maxQ="57.399999999999999"/>
+                    <iidm:point p="80" minQ="-53.514000000000003" maxQ="36.399999999999999"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="CD" energySource="HYDRO" minP="0" maxP="35" voltageRegulatorOn="true" targetP="21.789588999999999" targetV="236.44736" targetQ="-20.701546" bus="N_0" connectableBus="N_0" p="-21.789588999999999" q="20.693394000000001">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-20.600000000000001" maxQ="18.100000000000001"/>
+                    <iidm:point p="35" minQ="-21.725000000000001" maxQ="6.3500003999999999"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:load id="CF" loadType="UNDEFINED" p0="8.4558540000000004" q0="-23.695924999999999" bus="N_0" connectableBus="N_0" p="8.4558540000000004" q="-23.695924999999999"/>
+            <iidm:load id="CG" loadType="UNDEFINED" p0="90.399109999999993" q0="-51.968690000000002" bus="N_0" connectableBus="N_0" p="90.399109999999993" q="-51.968690000000002"/>
+            <iidm:load id="CH" loadType="UNDEFINED" p0="-5.1022489999999996" q0="4.9081216000000003" bus="N_0" connectableBus="N_0" p="-5.1022489999999996" q="4.9081216000000003"/>
+            <iidm:load id="CE" loadType="UNDEFINED" p0="-72.186890000000005" q0="50.168945000000001" bus="N_3" connectableBus="N_3" p="-72.186890000000005" q="50.168945000000001"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="CI" r="2" x="14.744999999999999" g="0" b="3.1999999999999999e-05" ratedU1="225" ratedU2="225" bus1="C_0" connectableBus1="C_0" voltageLevelId1="C" bus2="N_0" connectableBus2="N_0" voltageLevelId2="N">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="22" regulationMode="CURRENT_LIMITER" regulationValue="930.66669999999999" regulating="false">
+                <iidm:terminalRef id="CI" side="ONE"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="-42.799999999999997"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="-40.18"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="-37.539999999999999"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="-34.899999999999999"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="-32.259999999999998"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="-29.600000000000001"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="-26.940000000000001"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="-24.260000000000002"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="-21.579999999999998"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="-18.899999999999999"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="-16.219999999999999"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="-13.52"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="-10.82"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="-8.1199999999999992"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="-5.4199999999999999"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="-2.7000000000000002"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="0"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="2.7000000000000002"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="5.4199999999999999"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="8.1199999999999992"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="10.82"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="13.52"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="16.219999999999999"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="18.899999999999999"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="21.579999999999998"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="24.260000000000002"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="26.940000000000001"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="29.600000000000001"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="32.259999999999998"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="34.899999999999999"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="37.539999999999999"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="40.18"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="42.799999999999997"/>
+            </iidm:phaseTapChanger>
+            <iidm:currentLimits1 permanentLimit="931"/>
+            <iidm:currentLimits2 permanentLimit="931"/>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="CJ" r="0.0099999990000000007" x="0.10000002400000001" g1="0" b1="0" g2="0" b2="0" bus1="C_0" connectableBus1="C_0" voltageLevelId1="C" bus2="N_3" connectableBus2="N_3" voltageLevelId2="N">
+        <iidm:currentLimits1 permanentLimit="931"/>
+        <iidm:currentLimits2 permanentLimit="931">
+            <iidm:temporaryLimit name="IST" value="1640" fictitious="true"/>
+            <iidm:temporaryLimit name="IT1" acceptableDuration="60"/>
+        </iidm:currentLimits2>
+    </iidm:line>
+</iidm:network>
diff --git a/test/resources/V1_5/fictitiousSwitchRef.xml b/test/resources/V1_5/fictitiousSwitchRef.xml
new file mode 100644
index 00000000..77738e69
--- /dev/null
+++ b/test/resources/V1_5/fictitiousSwitchRef.xml
@@ -0,0 +1,122 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="fictitious" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="A" country="FR">
+        <iidm:voltageLevel id="C" nominalV="225" lowVoltageLimit="0" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="D" name="E" node="0"/>
+                <iidm:switch id="F" name="G" fictitious="true" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="H" name="I" fictitious="true" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="3"/>
+                <iidm:switch id="J" name="K" fictitious="true" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+                <iidm:switch id="L" name="M" fictitious="true" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:bus v="234.40912" angle="0" nodes="0,1,2,3,4"/>
+            </iidm:nodeBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="N" nominalV="225" lowVoltageLimit="220" highVoltageLimit="245.00002000000001" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="O" name="E" node="0"/>
+                <iidm:busbarSection id="P" name="Q" node="1"/>
+                <iidm:switch id="R" name="S" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="19"/>
+                <iidm:switch id="T" name="U" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="17"/>
+                <iidm:switch id="V" name="W" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="21"/>
+                <iidm:switch id="X" name="Y" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="11"/>
+                <iidm:switch id="Z" name="AA" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="13"/>
+                <iidm:switch id="AB" name="AC" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="15"/>
+                <iidm:switch id="AD" name="AE" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="8"/>
+                <iidm:switch id="AF" name="AG" fictitious="true" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="2"/>
+                <iidm:switch id="AH" name="AI" kind="DISCONNECTOR" retained="false" open="false" node1="7" node2="0"/>
+                <iidm:switch id="AJ" name="AK" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="6"/>
+                <iidm:switch id="AL" name="AM" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="19"/>
+                <iidm:switch id="AN" name="AO" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="17"/>
+                <iidm:switch id="AP" name="AQ" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="21"/>
+                <iidm:switch id="AR" name="AS" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="11"/>
+                <iidm:switch id="AT" name="AU" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="13"/>
+                <iidm:switch id="AV" name="AW" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="15"/>
+                <iidm:switch id="AX" name="AY" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="8"/>
+                <iidm:switch id="AZ" name="BA" fictitious="true" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="2"/>
+                <iidm:switch id="BB" name="BC" fictitious="true" kind="BREAKER" retained="true" open="true" node1="2" node2="3"/>
+                <iidm:switch id="BD" name="BE" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:switch id="BF" name="BG" kind="DISCONNECTOR" retained="false" open="false" node1="3" node2="5"/>
+                <iidm:switch id="BH" name="BI" kind="DISCONNECTOR" retained="false" open="true" node1="9" node2="3"/>
+                <iidm:switch id="BJ" name="BK" kind="BREAKER" retained="true" open="false" node1="6" node2="7"/>
+                <iidm:switch id="BL" name="BM" kind="BREAKER" retained="true" open="false" node1="8" node2="9"/>
+                <iidm:switch id="BN" name="BO" kind="DISCONNECTOR" retained="false" open="false" node1="9" node2="10"/>
+                <iidm:switch id="BP" name="BQ" kind="BREAKER" retained="true" open="true" node1="11" node2="12"/>
+                <iidm:switch id="BR" name="BS" kind="BREAKER" retained="true" open="true" node1="13" node2="14"/>
+                <iidm:switch id="BT" name="BU" kind="BREAKER" retained="true" open="false" node1="15" node2="16"/>
+                <iidm:switch id="BV" name="BW" kind="BREAKER" retained="true" open="false" node1="17" node2="18"/>
+                <iidm:switch id="BX" name="BY" kind="BREAKER" retained="true" open="false" node1="19" node2="20"/>
+                <iidm:switch id="BZ" name="CA" kind="BREAKER" retained="true" open="false" node1="21" node2="22"/>
+                <iidm:bus v="236.44736" angle="15.250391" nodes="0,1,6,7,8,9,10,15,16,17,18,19,20,21,22"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:generator id="CB" energySource="HYDRO" minP="0" maxP="70" voltageRegulatorOn="false" targetP="0" targetV="0" targetQ="0" node="12">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-59.299999999999997" maxQ="60"/>
+                    <iidm:point p="70" minQ="-54.549999999999997" maxQ="46.25"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="CC" energySource="HYDRO" minP="0" maxP="80" voltageRegulatorOn="false" targetP="0" targetV="0" targetQ="0" node="14">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-56.799999999999997" maxQ="57.399999999999999"/>
+                    <iidm:point p="80" minQ="-53.514000000000003" maxQ="36.399999999999999"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="CD" energySource="HYDRO" minP="0" maxP="35" voltageRegulatorOn="true" targetP="21.789588999999999" targetV="236.44736" targetQ="-20.701546" node="16" p="-21.789588999999999" q="20.693394000000001">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-20.600000000000001" maxQ="18.100000000000001"/>
+                    <iidm:point p="35" minQ="-21.725000000000001" maxQ="6.3500003999999999"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:load id="CE" loadType="UNDEFINED" p0="-72.186890000000005" q0="50.168945000000001" node="4" p="-72.186890000000005" q="50.168945000000001"/>
+            <iidm:load id="CF" loadType="UNDEFINED" p0="8.4558540000000004" q0="-23.695924999999999" node="18" p="8.4558540000000004" q="-23.695924999999999"/>
+            <iidm:load id="CG" loadType="UNDEFINED" p0="90.399109999999993" q0="-51.968690000000002" node="20" p="90.399109999999993" q="-51.968690000000002"/>
+            <iidm:load id="CH" loadType="UNDEFINED" p0="-5.1022489999999996" q0="4.9081216000000003" node="22" p="-5.1022489999999996" q="4.9081216000000003"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="CI" r="2" x="14.744999999999999" g="0" b="3.1999999999999999e-05" ratedU1="225" ratedU2="225" ratedS="1" node1="2" voltageLevelId1="C" node2="10" voltageLevelId2="N">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="22" regulationMode="CURRENT_LIMITER" regulationValue="930.66669999999999" regulating="false">
+                <iidm:terminalRef id="CI" side="ONE"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="-42.799999999999997"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="-40.18"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="-37.539999999999999"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="-34.899999999999999"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="-32.259999999999998"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="-29.600000000000001"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="-26.940000000000001"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="-24.260000000000002"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="-21.579999999999998"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="-18.899999999999999"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="-16.219999999999999"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="-13.52"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="-10.82"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="-8.1199999999999992"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="-5.4199999999999999"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="-2.7000000000000002"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="0"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="2.7000000000000002"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="5.4199999999999999"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="8.1199999999999992"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="10.82"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="13.52"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="16.219999999999999"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="18.899999999999999"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="21.579999999999998"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="24.260000000000002"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="26.940000000000001"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="29.600000000000001"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="32.259999999999998"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="34.899999999999999"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="37.539999999999999"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="40.18"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="42.799999999999997"/>
+            </iidm:phaseTapChanger>
+            <iidm:currentLimits1 permanentLimit="931"/>
+            <iidm:currentLimits2 permanentLimit="931"/>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="CJ" r="0.0099999990000000007" x="0.10000002400000001" g1="0" b1="0" g2="0" b2="0" node1="4" voltageLevelId1="C" node2="5" voltageLevelId2="N">
+        <iidm:currentLimits1 permanentLimit="931"/>
+        <iidm:currentLimits2 permanentLimit="931">
+            <iidm:temporaryLimit name="IST" value="1640" fictitious="true"/>
+            <iidm:temporaryLimit name="IT1" acceptableDuration="60"/>
+        </iidm:currentLimits2>
+    </iidm:line>
+</iidm:network>
diff --git a/test/resources/V1_5/fourSubstationsNbk.xml b/test/resources/V1_5/fourSubstationsNbk.xml
new file mode 100644
index 00000000..80f56069
--- /dev/null
+++ b/test/resources/V1_5/fourSubstationsNbk.xml
@@ -0,0 +1,202 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="fourSubstations" caseDate="2017-06-25T17:43:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S1">
+        <iidm:voltageLevel id="S1VL1" nominalV="225" lowVoltageLimit="220" highVoltageLimit="240" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="S1VL1_BBS" name="S1VL1_BBS" node="0"/>
+                <iidm:switch id="S1VL1_BBS_LD1_DISCONNECTOR" name="S1VL1_BBS_LD1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="S1VL1_LD1_BREAKER" name="S1VL1_LD1_BREAKER" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+                <iidm:switch id="S1VL1_BBS_TWT_DISCONNECTOR" name="S1VL1_BBS_TWT_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="3"/>
+                <iidm:switch id="S1VL1_TWT_BREAKER" name="S1VL1_TWT_BREAKER" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:bus v="224.6139" angle="2.2822" nodes="0,1,2,3,4"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:load id="LD1" loadType="UNDEFINED" p0="80" q0="10" node="2" p="80" q="10"/>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="S1VL2" nominalV="400" lowVoltageLimit="390" highVoltageLimit="440" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="S1VL2_BBS1" name="S1VL2_BBS1" node="0"/>
+                <iidm:busbarSection id="S1VL2_BBS2" name="S1VL2_BBS2" node="1"/>
+                <iidm:switch id="S1VL2_BBS1_TWT_DISCONNECTOR" name="S1VL2_BBS1_TWT_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="2"/>
+                <iidm:switch id="S1VL2_BBS2_TWT_DISCONNECTOR" name="S1VL2_BBS2_TWT_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="2"/>
+                <iidm:switch id="S1VL2_TWT_BREAKER" name="S1VL2_TWT_BREAKER" kind="BREAKER" retained="true" open="false" node1="2" node2="3"/>
+                <iidm:switch id="S1VL2_BBS1_VSC1_DISCONNECTOR" name="S1VL2_BBS1_VSC1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="4"/>
+                <iidm:switch id="S1VL2_BBS2_VSC1_DISCONNECTOR" name="S1VL2_BBS2_VSC1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="4"/>
+                <iidm:switch id="S1VL2_VSC1_BREAKER" name="S1VL2_VSC1_BREAKER" kind="BREAKER" retained="true" open="false" node1="4" node2="5"/>
+                <iidm:switch id="S1VL2_BBS1_GH1_DISCONNECTOR" name="S1VL2_BBS1_GH1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="6"/>
+                <iidm:switch id="S1VL2_BBS1_GH2_DISCONNECTOR" name="S1VL2_BBS1_GH2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="8"/>
+                <iidm:switch id="S1VL2_BBS1_GH3_DISCONNECTOR" name="S1VL2_BBS1_GH3_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="10"/>
+                <iidm:switch id="S1VL2_BBS2_GH1_DISCONNECTOR" name="S1VL2_BBS2_GH1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="6"/>
+                <iidm:switch id="S1VL2_BBS2_GH2_DISCONNECTOR" name="S1VL2_BBS2_GH2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="8"/>
+                <iidm:switch id="S1VL2_BBS2_GH3_DISCONNECTOR" name="S1VL2_BBS2_GH3_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="10"/>
+                <iidm:switch id="S1VL2_GH1_BREAKER" name="S1VL2_GH1_BREAKER" kind="BREAKER" retained="true" open="false" node1="6" node2="7"/>
+                <iidm:switch id="S1VL2_GH2_BREAKER" name="S1VL2_GH2_BREAKER" kind="BREAKER" retained="true" open="false" node1="8" node2="9"/>
+                <iidm:switch id="S1VL2_GH3_BREAKER" name="S1VL2_GH3_BREAKER" kind="BREAKER" retained="true" open="false" node1="10" node2="11"/>
+                <iidm:switch id="S1VL2_BBS1_LD2_DISCONNECTOR" name="S1VL2_BBS1_LD2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="12"/>
+                <iidm:switch id="S1VL2_BBS1_LD3_DISCONNECTOR" name="S1VL2_BBS1_LD3_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="14"/>
+                <iidm:switch id="S1VL2_BBS1_LD4_DISCONNECTOR" name="S1VL2_BBS1_LD4_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="16"/>
+                <iidm:switch id="S1VL2_BBS2_LD2_DISCONNECTOR" name="S1VL2_BBS2_LD2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="12"/>
+                <iidm:switch id="S1VL2_BBS2_LD3_DISCONNECTOR" name="S1VL2_BBS2_LD3_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="14"/>
+                <iidm:switch id="S1VL2_BBS2_LD4_DISCONNECTOR" name="S1VL2_BBS2_LD4_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="16"/>
+                <iidm:switch id="S1VL2_LD2_BREAKER" name="S1VL2_LD2_BREAKER" kind="BREAKER" retained="true" open="false" node1="12" node2="13"/>
+                <iidm:switch id="S1VL2_LD3_BREAKER" name="S1VL2_LD3_BREAKER" kind="BREAKER" retained="true" open="false" node1="14" node2="15"/>
+                <iidm:switch id="S1VL2_LD4_BREAKER" name="S1VL2_LD4_BREAKER" kind="BREAKER" retained="true" open="false" node1="16" node2="17"/>
+                <iidm:switch id="S1VL2_BBS1_SHUNT_DISCONNECTOR" name="S1VL2_BBS1_SHUNT_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="18"/>
+                <iidm:switch id="S1VL2_BBS2_SHUNT_DISCONNECTOR" name="S1VL2_BBS2_SHUNT_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="1" node2="18"/>
+                <iidm:switch id="S1VL2_SHUNT_BREAKER" name="S1VL2_SHUNT_BREAKER" kind="BREAKER" retained="true" open="false" node1="18" node2="19"/>
+                <iidm:switch id="S1VL2_BBS1_LCC1_DISCONNECTOR" name="S1VL2_BBS1_LCC1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="true" node1="0" node2="20"/>
+                <iidm:switch id="S1VL2_BBS2_LCC1_DISCONNECTOR" name="S1VL2_BBS2_LCC1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="20"/>
+                <iidm:switch id="S1VL2_LCC1_BREAKER" name="S1VL2_LCC1_BREAKER" kind="BREAKER" retained="true" open="false" node1="20" node2="21"/>
+                <iidm:switch id="S1VL2_BBS1_COUPLER_DISCONNECTOR" name="S1VL2_BBS1_COUPLER_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="22"/>
+                <iidm:switch id="S1VL2_BBS2_COUPLER_DISCONNECTOR" name="S1VL2_BBS2_COUPLER_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="1" node2="23"/>
+                <iidm:switch id="S1VL2_COUPLER" name="S1VL2_COUPLER" kind="BREAKER" retained="true" open="false" node1="22" node2="23"/>
+                <iidm:bus v="400" angle="0" nodes="0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:generator id="GH1" energySource="HYDRO" minP="0" maxP="100" voltageRegulatorOn="true" targetP="85.356999999999999" targetV="400" targetQ="512.08100000000002" node="7" p="-85.356999999999999" q="-512.08140000000003">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-769.29999999999995" maxQ="860"/>
+                    <iidm:point p="100" minQ="-864.54999999999995" maxQ="946.25"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="GH2" energySource="HYDRO" minP="0" maxP="200" voltageRegulatorOn="true" targetP="90" targetV="400" targetQ="512.08100000000002" node="9" p="-90" q="-512.08140000000003">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-556.79999999999995" maxQ="557.39999999999998"/>
+                    <iidm:point p="200" minQ="-553.51400000000001" maxQ="536.39999999999998"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="GH3" energySource="HYDRO" minP="0" maxP="200" voltageRegulatorOn="true" targetP="155.714" targetV="400" targetQ="512.08100000000002" node="11" p="-155.714" q="-512.08140000000003">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-680.60000000000002" maxQ="688.10000000000002"/>
+                    <iidm:point p="200" minQ="-681.72500000000002" maxQ="716.3500004"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:load id="LD2" loadType="UNDEFINED" p0="60" q0="5" node="13" p="60" q="5"/>
+            <iidm:load id="LD3" loadType="UNDEFINED" p0="60" q0="5" node="15" p="60" q="5"/>
+            <iidm:load id="LD4" loadType="UNDEFINED" p0="40" q0="5" node="17" p="40" q="5"/>
+            <iidm:shunt id="SHUNT" sectionCount="1" voltageRegulatorOn="false" node="19" q="1920">
+                <iidm:shuntLinearModel bPerSection="-0.012" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:vscConverterStation id="VSC1" name="VSC1" voltageRegulatorOn="true" lossFactor="1.1000000000000001" voltageSetpoint="400" reactivePowerSetpoint="500" node="5" p="10.109999999999999" q="-512.08140000000003">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="-100" minQ="-550" maxQ="570"/>
+                    <iidm:point p="100" minQ="-550" maxQ="570"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:vscConverterStation>
+            <iidm:lccConverterStation id="LCC1" name="LCC1" lossFactor="1.1000000000000001" powerFactor="0.59999999999999998" node="21" p="80.879999999999995"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="TWT" r="2" x="14.744999999999999" g="0" b="3.1999999999999999e-05" ratedU1="225" ratedU2="400" node1="4" voltageLevelId1="S1VL1" node2="3" voltageLevelId2="S1VL2" p1="-80" q1="-10" p2="80.0809" q2="5.4856999999999996">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="15" regulationMode="FIXED_TAP">
+                <iidm:terminalRef id="TWT" side="ONE"/>
+                <iidm:step r="39.784730000000003" x="29.784725000000002" g="0" b="0" rho="1" alpha="-42.799999999999997"/>
+                <iidm:step r="31.720244999999998" x="21.720241999999999" g="0" b="0" rho="1" alpha="-40.18"/>
+                <iidm:step r="23.655736999999998" x="13.655735" g="0" b="0" rho="1" alpha="-37.539999999999999"/>
+                <iidm:step r="16.263271" x="6.2632680000000001" g="0" b="0" rho="1" alpha="-34.899999999999999"/>
+                <iidm:step r="9.5428470000000001" x="4.5428420000000003" g="0" b="0" rho="1" alpha="-32.259999999999998"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="-29.600000000000001"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="-26.940000000000001"/>
+                <iidm:step r="-7.2581949999999997" x="-3.2581954" g="0" b="0" rho="1" alpha="-24.260000000000002"/>
+                <iidm:step r="-11.962484999999999" x="-7.9624839999999999" g="0" b="0" rho="1" alpha="-21.579999999999998"/>
+                <iidm:step r="-15.994745" x="-11.994745" g="0" b="0" rho="1" alpha="-18.899999999999999"/>
+                <iidm:step r="-19.354952000000001" x="-15.354952000000001" g="0" b="0" rho="1" alpha="-16.219999999999999"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="-13.52"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="-10.82"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="-8.1199999999999992"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="-5.4199999999999999"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="-2.7000000000000002"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="0"/>
+                <iidm:step r="-28.763538" x="-28.763535999999998" g="0" b="0" rho="1" alpha="2.7000000000000002"/>
+                <iidm:step r="-28.091502999999999" x="-28.091502999999999" g="0" b="0" rho="1" alpha="5.4199999999999999"/>
+                <iidm:step r="-26.747416999999999" x="-26.747416999999999" g="0" b="0" rho="1" alpha="8.1199999999999992"/>
+                <iidm:step r="-24.731290000000001" x="-24.731286999999998" g="0" b="0" rho="1" alpha="10.82"/>
+                <iidm:step r="-22.043126999999998" x="-22.043129" g="0" b="0" rho="1" alpha="13.52"/>
+                <iidm:step r="-19.354952000000001" x="-19.354952000000001" g="0" b="0" rho="1" alpha="16.219999999999999"/>
+                <iidm:step r="-15.994745" x="-15.994745" g="0" b="0" rho="1" alpha="18.899999999999999"/>
+                <iidm:step r="-11.962484999999999" x="-11.962484" g="0" b="0" rho="1" alpha="21.579999999999998"/>
+                <iidm:step r="-7.2581949999999997" x="-7.2581954" g="0" b="0" rho="1" alpha="24.260000000000002"/>
+                <iidm:step r="-1.8818557" x="-1.8818527" g="0" b="0" rho="1" alpha="26.940000000000001"/>
+                <iidm:step r="3.4944772999999998" x="3.4944772999999998" g="0" b="0" rho="1" alpha="29.600000000000001"/>
+                <iidm:step r="9.5428470000000001" x="9.5428420000000003" g="0" b="0" rho="1" alpha="32.259999999999998"/>
+                <iidm:step r="16.263271" x="16.263268" g="0" b="0" rho="1" alpha="34.899999999999999"/>
+                <iidm:step r="23.655736999999998" x="23.655735" g="0" b="0" rho="1" alpha="37.539999999999999"/>
+                <iidm:step r="31.720244999999998" x="31.720241999999999" g="0" b="0" rho="1" alpha="40.18"/>
+                <iidm:step r="39.784730000000003" x="39.784725000000002" g="0" b="0" rho="1" alpha="42.799999999999997"/>
+            </iidm:phaseTapChanger>
+            <iidm:currentLimits1 permanentLimit="1031"/>
+            <iidm:currentLimits2 permanentLimit="1031"/>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:substation id="S2">
+        <iidm:voltageLevel id="S2VL1" nominalV="400" lowVoltageLimit="390" highVoltageLimit="440" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="S2VL1_BBS" name="S2VL1_BBS" node="0"/>
+                <iidm:switch id="S2VL1_BBS_GTH1_DISCONNECTOR" name="S2VL1_BBS_GTH1_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="S2VL1_GTH1_BREAKER" name="S2VL1_GTH1_BREAKER" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+                <iidm:switch id="S2VL1_BBS_VSC2_DISCONNECTOR" name="S2VL1_BBS_VSC2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="3"/>
+                <iidm:switch id="S2VL1_VSC2_BREAKER" name="S2VL1_VSC2_BREAKER" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:switch id="S2VL1_BBS_LINES2S3_DISCONNECTOR" name="S2VL1_BBS_LINES2S3_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="5"/>
+                <iidm:switch id="S2VL1_LINES2S3_BREAKER" name="S2VL1_LINES2S3_BREAKER" kind="BREAKER" retained="true" open="false" node1="5" node2="6"/>
+                <iidm:bus v="408.84699999999998" angle="0.73470000000000002" nodes="0,1,2,3,4,5,6"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:generator id="GTH1" energySource="THERMAL" minP="0" maxP="100" voltageRegulatorOn="false" targetP="100" targetV="400" targetQ="70" node="2" p="-100" q="-70">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-76.799999999999997" maxQ="77.400000000000006"/>
+                    <iidm:point p="100" minQ="-73.513999999999996" maxQ="76.400000000000006"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:vscConverterStation id="VSC2" name="VSC2" voltageRegulatorOn="false" lossFactor="1.1000000000000001" voltageSetpoint="0" reactivePowerSetpoint="120" node="4" p="-9.8900000000000006" q="-120">
+                <iidm:minMaxReactiveLimits minQ="-400" maxQ="500"/>
+            </iidm:vscConverterStation>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S3">
+        <iidm:voltageLevel id="S3VL1" nominalV="400" lowVoltageLimit="390" highVoltageLimit="440" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="S3VL1_BBS" name="S3VL1_BBS" node="0"/>
+                <iidm:switch id="S3VL1_BBS_LINES2S3_DISCONNECTOR" name="S3VL1_BBS_LINES2S3_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="S3VL1_LINES2S3_BREAKER" name="S3VL1_LINES2S3_BREAKER" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+                <iidm:switch id="S3VL1_BBS_LD5_DISCONNECTOR" name="S3VL1_BBS_LD5_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="3"/>
+                <iidm:switch id="S3VL1_LD5_BREAKER" name="S3VL1_LD5_BREAKER" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:switch id="S3VL1_BBS_GTH2_DISCONNECTOR" name="S3VL1_BBS_GTH2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="5"/>
+                <iidm:switch id="S3VL1_GTH2_BREAKER" name="S3VL1_GTH2_BREAKER" kind="BREAKER" retained="true" open="false" node1="5" node2="6"/>
+                <iidm:switch id="S3VL1_BBS_LINES3S4_DISCONNECTOR" name="S3VL1_BBS_LINES3S4_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="7"/>
+                <iidm:switch id="S3VL1_LINES3S4_BREAKER" name="S3VL1_LINES3S4_BREAKER" kind="BREAKER" retained="true" open="false" node1="7" node2="8"/>
+                <iidm:switch id="S3VL1_BBS_LCC2_DISCONNECTOR" name="S3VL1_BBS_LCC2_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="9"/>
+                <iidm:switch id="S3VL1_LCC2_BREAKER" name="S3VL1_LCC2_BREAKER" kind="BREAKER" retained="true" open="false" node1="9" node2="10"/>
+                <iidm:bus v="400" angle="0" nodes="0,1,2,3,4,5,6,7,8,9,10"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:generator id="GTH2" energySource="THERMAL" minP="0" maxP="400" voltageRegulatorOn="true" targetP="250.99440000000001" targetV="400" targetQ="71.848699999999994" node="6" p="-250.99440000000001" q="71.848699999999994">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="0" minQ="-169.30000000000001" maxQ="200"/>
+                    <iidm:point p="400" minQ="-174.55000000000001" maxQ="176.25"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:load id="LD5" loadType="UNDEFINED" p0="200" q0="5" node="4" p="200" q="5"/>
+            <iidm:lccConverterStation id="LCC2" name="LCC2" lossFactor="1.1000000000000001" powerFactor="0.59999999999999998" node="10" p="-79.120000000000005"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S4">
+        <iidm:voltageLevel id="S4VL1" nominalV="400" lowVoltageLimit="390" highVoltageLimit="440" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="S4VL1_BBS" name="S4VL1_BBS" node="0"/>
+                <iidm:switch id="S4VL1_BBS_LINES3S4_DISCONNECTOR" name="S4VL1_BBS_LINES3S4_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="5"/>
+                <iidm:switch id="S4VL1_LINES3S4_BREAKER" name="S4VL1_LINES3S4_BREAKER" kind="BREAKER" retained="true" open="false" node1="5" node2="6"/>
+                <iidm:switch id="S4VL1_BBS_LD6_DISCONNECTOR" name="S4VL1_BBS_LD6_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="1"/>
+                <iidm:switch id="S4VL1_LD6_BREAKER" name="S4VL1_LD6_BREAKER" kind="BREAKER" retained="true" open="false" node1="1" node2="2"/>
+                <iidm:switch id="S4VL1_BBS_SVC_DISCONNECTOR" name="S4VL1_BBS_SVC_DISCONNECTOR" kind="DISCONNECTOR" retained="false" open="false" node1="0" node2="3"/>
+                <iidm:switch id="S4VL1_SVC_BREAKER" name="S4VL1_SVC_BREAKER" kind="BREAKER" retained="true" open="false" node1="3" node2="4"/>
+                <iidm:bus v="400" angle="-1.1258999999999999" nodes="0,1,2,3,4,5,6"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:load id="LD6" loadType="UNDEFINED" p0="240" q0="10" node="2" p="240" q="10"/>
+            <iidm:staticVarCompensator id="SVC" bMin="-0.050000000000000003" bMax="0.050000000000000003" voltageSetpoint="400" regulationMode="VOLTAGE" node="4" q="-12.541499999999999"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:line id="LINE_S2S3" r="0.0099999990000000007" x="19.100000024" g1="0" b1="0" g2="0" b2="0" node1="6" voltageLevelId1="S2VL1" node2="2" voltageLevelId2="S3VL1" p1="109.88930000000001" q1="190.02289999999999" p2="-109.88639999999999" q2="-184.5171"/>
+    <iidm:line id="LINE_S3S4" r="0.0099999990000000007" x="13.100000024" g1="0" b1="0" g2="0" b2="0" node1="8" voltageLevelId1="S3VL1" node2="6" voltageLevelId2="S4VL1" p1="240.00360000000001" q1="2.1751" p2="-240" q2="2.5415000000000001">
+        <iidm:currentLimits1 permanentLimit="931"/>
+        <iidm:currentLimits2 permanentLimit="931">
+            <iidm:temporaryLimit name="IST" value="1640" fictitious="true"/>
+            <iidm:temporaryLimit name="LD71" acceptableDuration="60"/>
+        </iidm:currentLimits2>
+    </iidm:line>
+    <iidm:hvdcLine id="HVDC1" name="HVDC1" r="1" nominalV="400" convertersMode="SIDE_1_RECTIFIER_SIDE_2_INVERTER" activePowerSetpoint="10" maxP="300" converterStation1="VSC1" converterStation2="VSC2"/>
+    <iidm:hvdcLine id="HVDC2" name="HVDC2" r="1" nominalV="400" convertersMode="SIDE_1_RECTIFIER_SIDE_2_INVERTER" activePowerSetpoint="80" maxP="300" converterStation1="LCC1" converterStation2="LCC2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/internalConnections.xml b/test/resources/V1_5/internalConnections.xml
new file mode 100644
index 00000000..cc3b3329
--- /dev/null
+++ b/test/resources/V1_5/internalConnections.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="internal-connections" caseDate="2018-11-08T12:33:26.208000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="s1" country="ES">
+        <iidm:voltageLevel id="vl1" nominalV="400" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="b1" node="2"/>
+                <iidm:switch id="br1" kind="BREAKER" retained="false" open="false" node1="1" node2="2"/>
+                <iidm:internalConnection node1="0" node2="1"/>
+                <iidm:internalConnection node1="3" node2="4"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:generator id="g1" energySource="OTHER" minP="0" maxP="100" voltageRegulatorOn="true" targetP="10" targetV="400" node="0">
+                <iidm:minMaxReactiveLimits minQ="-1.7976931348623157e+308" maxQ="1.7976931348623157e+308"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="s2" country="ES">
+        <iidm:voltageLevel id="vl2" nominalV="400" topologyKind="NODE_BREAKER">
+            <iidm:nodeBreakerTopology>
+                <iidm:busbarSection id="b2" node="2"/>
+                <iidm:switch id="br2" kind="BREAKER" retained="false" open="false" node1="1" node2="2"/>
+                <iidm:internalConnection node1="0" node2="1"/>
+                <iidm:internalConnection node1="3" node2="4"/>
+            </iidm:nodeBreakerTopology>
+            <iidm:load id="l2" loadType="UNDEFINED" p0="10" q0="1" node="0"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:line id="line1-2" r="0.10000000000000001" x="10" g1="0" b1="0" g2="0" b2="0" node1="4" voltageLevelId1="vl1" node2="4" voltageLevelId2="vl2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/loadDetailRef.xml b/test/resources/V1_5/loadDetailRef.xml
new file mode 100644
index 00000000..0af74498
--- /dev/null
+++ b/test/resources/V1_5/loadDetailRef.xml
@@ -0,0 +1,14 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:ld="http://www.itesla_project.eu/schema/iidm/ext/load_detail/1_0" id="test" caseDate="2016-06-27T12:27:58.535000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S" country="FR">
+        <iidm:voltageLevel id="VL" nominalV="400" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="L" loadType="UNDEFINED" p0="100" q0="50" bus="B" connectableBus="B"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:extension id="L">
+        <ld:detail fixedActivePower="40" fixedReactivePower="20" variableActivePower="60" variableReactivePower="30"/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/multiple-extensions.xml b/test/resources/V1_5/multiple-extensions.xml
new file mode 100644
index 00000000..6b304a53
--- /dev/null
+++ b/test/resources/V1_5/multiple-extensions.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:bar="http://www.itesla_project.eu/schema/iidm/ext/loadbar/1_0" xmlns:foo="http://www.itesla_project.eu/schema/iidm/ext/loadfoo/1_0" id="test" caseDate="2017-11-17T12:00:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S" country="FR">
+        <iidm:voltageLevel id="VL" nominalV="20" lowVoltageLimit="15" highVoltageLimit="25" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="0" q0="0" bus="BUS" connectableBus="BUS"/>
+            <iidm:load id="LOAD2" loadType="UNDEFINED" p0="0" q0="0" bus="BUS" connectableBus="BUS"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:extension id="LOAD">
+        <bar:loadBar/>
+        <foo:loadFoo/>
+    </iidm:extension>
+    <iidm:extension id="LOAD2">
+        <foo:loadFoo/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/nonLinearShuntRoundTripRef.xml b/test/resources/V1_5/nonLinearShuntRoundTripRef.xml
new file mode 100644
index 00000000..e8338788
--- /dev/null
+++ b/test/resources/V1_5/nonLinearShuntRoundTripRef.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="shuntTestCase" caseDate="2019-09-30T16:29:18.263000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1"/>
+            </iidm:busBreakerTopology>
+            <iidm:shunt id="SHUNT" sectionCount="1" voltageRegulatorOn="true" targetV="200" targetDeadband="5" bus="B1" connectableBus="B1">
+                <iidm:property name="test" value="test"/>
+                <iidm:shuntNonLinearModel>
+                    <iidm:section b="1.0000000000000001e-05" g="0"/>
+                    <iidm:section b="0.02" g="0.29999999999999999"/>
+                </iidm:shuntNonLinearModel>
+                <iidm:regulatingTerminal id="LOAD"/>
+            </iidm:shunt>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="220" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B2"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="100" q0="50" bus="B2" connectableBus="B2"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/optionalLoadTypeBug.xml b/test/resources/V1_5/optionalLoadTypeBug.xml
new file mode 100644
index 00000000..fe70027d
--- /dev/null
+++ b/test/resources/V1_5/optionalLoadTypeBug.xml
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="test" caseDate="2014-02-12T13:19:17+01:00" forecastDistance="0" sourceFormat="???">
+    <iidm:substation id="S" country="FR" tso="RTE">
+        <iidm:voltageLevel id="V" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="L" p0="1" q0="2" bus="B" connectableBus="B"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/phaseShifterRoundTripRef.xml b/test/resources/V1_5/phaseShifterRoundTripRef.xml
new file mode 100644
index 00000000..71e1e4f0
--- /dev/null
+++ b/test/resources/V1_5/phaseShifterRoundTripRef.xml
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="phaseShifterTestCase" caseDate="2016-10-18T10:06:00+02:00" forecastDistance="0" sourceFormat="code">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1" v="400" angle="0"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="G1" energySource="OTHER" minP="50" maxP="150" voltageRegulatorOn="true" targetP="100" targetV="400" bus="B1" connectableBus="B1" p="-100.16797" q="-58.402831999999997">
+                <iidm:minMaxReactiveLimits minQ="-1.7976931348623157e+308" maxQ="1.7976931348623157e+308"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL3" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B3" v="392.64429999999999" angle="-1.8060944999999999"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="PS1" r="2" x="100" g="0" b="0" ratedU1="380" ratedU2="380" bus1="B1" connectableBus1="B1" voltageLevelId1="VL1" bus2="B3" connectableBus2="B3" voltageLevelId2="VL3" p1="50.084029999999998" q1="29.201415999999998" p2="-50.042014999999999" q2="-27.100708000000001">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="10" regulationMode="FIXED_TAP" regulationValue="200">
+                <iidm:terminalRef id="PS1" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1" alpha="-20"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1" alpha="0"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1" alpha="20"/>
+            </iidm:phaseTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B2" v="385.6934" angle="-3.6792064"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LD2" loadType="UNDEFINED" p0="100" q0="50" bus="B2" connectableBus="B2" p="100" q="50"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:line id="L1" r="4" x="200" g1="0" b1="0" g2="0" b2="0" bus1="B1" connectableBus1="B1" voltageLevelId1="VL1" bus2="B2" connectableBus2="B2" voltageLevelId2="VL2" p1="50.084026000000001" q1="29.201415999999998" p2="-50" q2="-25"/>
+    <iidm:line id="L2" r="2" x="100" g1="0" b1="0" g2="0" b2="0" bus1="B3" connectableBus1="B3" voltageLevelId1="VL3" bus2="B2" connectableBus2="B2" voltageLevelId2="VL2" p1="50.042014999999999" q1="27.100708000000001" p2="-50" q2="-25"/>
+</iidm:network>
diff --git a/test/resources/V1_5/reactiveLimitsRoundTripRef.xml b/test/resources/V1_5/reactiveLimitsRoundTripRef.xml
new file mode 100644
index 00000000..7d8e535e
--- /dev/null
+++ b/test/resources/V1_5/reactiveLimitsRoundTripRef.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="ReactiveLimits" caseDate="2016-01-01T10:00:00+02:00" forecastDistance="0" sourceFormat="???">
+    <iidm:substation id="S" country="FR" tso="RTE">
+        <iidm:voltageLevel id="VL" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="G1" energySource="OTHER" minP="0" maxP="10" voltageRegulatorOn="true" targetP="10" targetV="380" bus="B" connectableBus="B">
+                <iidm:reactiveCapabilityCurve>
+                    <iidm:point p="5" minQ="1" maxQ="10"/>
+                    <iidm:point p="10" minQ="-10" maxQ="1"/>
+                </iidm:reactiveCapabilityCurve>
+            </iidm:generator>
+            <iidm:generator id="G2" energySource="OTHER" minP="0" maxP="10" voltageRegulatorOn="true" targetP="10" targetV="380" bus="B" connectableBus="B">
+                <iidm:minMaxReactiveLimits minQ="1" maxQ="10"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/regulatingStaticVarCompensatorRoundTripRef.xml b/test/resources/V1_5/regulatingStaticVarCompensatorRoundTripRef.xml
new file mode 100644
index 00000000..2f14899b
--- /dev/null
+++ b/test/resources/V1_5/regulatingStaticVarCompensatorRoundTripRef.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="svcTestCase" caseDate="2016-06-29T14:54:03.427000+02:00" forecastDistance="0" sourceFormat="code">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="G1" energySource="OTHER" minP="50" maxP="150" voltageRegulatorOn="true" targetP="100" targetV="400" bus="B1" connectableBus="B1">
+                <iidm:minMaxReactiveLimits minQ="-1.7976931348623157e+308" maxQ="1.7976931348623157e+308"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B2"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="L2" loadType="UNDEFINED" p0="100" q0="50" bus="B2" connectableBus="B2"/>
+            <iidm:staticVarCompensator id="SVC2" bMin="0.00020000000000000001" bMax="0.00080000000000000004" voltageSetpoint="390" regulationMode="VOLTAGE" bus="B2" connectableBus="B2">
+                <iidm:property name="test" value="test"/>
+                <iidm:regulatingTerminal id="L2"/>
+            </iidm:staticVarCompensator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:line id="L1" r="4" x="200" g1="0" b1="0" g2="0" b2="0" bus1="B1" connectableBus1="B1" voltageLevelId1="VL1" bus2="B2" connectableBus2="B2" voltageLevelId2="VL2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/regulatingTerminal.xml b/test/resources/V1_5/regulatingTerminal.xml
new file mode 100644
index 00000000..b45ff6dc
--- /dev/null
+++ b/test/resources/V1_5/regulatingTerminal.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="three-windings-transformer" caseDate="2018-03-05T13:30:30.486000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="SUBSTATION" country="FR">
+        <iidm:voltageLevel id="VL_132" nominalV="132" lowVoltageLimit="118.8" highVoltageLimit="145.19999999999999" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_132" v="133.584" angle="-9.6199999999999992"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="BUS_132" connectableBus="BUS_132">
+                <iidm:regulatingTerminal id="3WT" side="THREE"/>
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL_33" nominalV="33" lowVoltageLimit="29.699999999999999" highVoltageLimit="36.299999999999997" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_33" v="34.881" angle="-15.24"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_33" loadType="UNDEFINED" p0="11.199999999999999" q0="7.5" bus="BUS_33" connectableBus="BUS_33" p="11.199999999999999" q="7.5"/>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL_11" nominalV="11" lowVoltageLimit="9.9000000000000004" highVoltageLimit="12.1" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_11" v="11.781000000000001" angle="-15.24"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_11" loadType="UNDEFINED" p0="0" q0="-10.6" bus="BUS_11" connectableBus="BUS_11" p="0" q="-10.6"/>
+        </iidm:voltageLevel>
+        <iidm:threeWindingsTransformer id="3WT" r1="17.423999999999999" x1="1.7423999999999999" g1="0.0057392102846648297" b1="0.00057392102846648299" ratedU1="132" r2="1.089" x2="0.1089" g2="0" b2="0" ratedU2="33" r3="0.121" x3="0.0121" g3="0" b3="0" ratedU3="11" ratedU0="132" bus1="BUS_132" connectableBus1="BUS_132" voltageLevelId1="VL_132" bus2="BUS_33" connectableBus2="BUS_33" voltageLevelId2="VL_33" bus3="BUS_11" connectableBus3="BUS_11" voltageLevelId3="VL_11"/>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/shuntRoundTripRef.xml b/test/resources/V1_5/shuntRoundTripRef.xml
new file mode 100644
index 00000000..5fe3d083
--- /dev/null
+++ b/test/resources/V1_5/shuntRoundTripRef.xml
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="shuntTestCase" caseDate="2019-09-30T16:29:18.263000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1"/>
+            </iidm:busBreakerTopology>
+            <iidm:shunt id="SHUNT" sectionCount="1" voltageRegulatorOn="true" targetV="200" targetDeadband="5" bus="B1" connectableBus="B1">
+                <iidm:alias>Alias</iidm:alias>
+                <iidm:property name="test" value="test"/>
+                <iidm:shuntLinearModel bPerSection="1.0000000000000001e-05" maximumSectionCount="1"/>
+                <iidm:regulatingTerminal id="LOAD"/>
+            </iidm:shunt>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="220" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B2"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="100" q0="50" bus="B2" connectableBus="B2"/>
+        </iidm:voltageLevel>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/slackTerminal.xml b/test/resources/V1_5/slackTerminal.xml
new file mode 100644
index 00000000..c572c66c
--- /dev/null
+++ b/test/resources/V1_5/slackTerminal.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" xmlns:slt="http://www.powsybl.org/schema/iidm/ext/slack_terminal/1_2" id="sim1" caseDate="2019-05-27T12:17:02.504000+02:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056666666666658"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666666666665"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:line id="NHV1_NHV2_1" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:line id="NHV1_NHV2_2" r="3" x="33" g1="0" b1="0.000193" g2="0" b2="0.000193" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2"/>
+    <iidm:extension id="VLHV2">
+        <slt:slackTerminal id="NHV1_NHV2_1" side="TWO"/>
+    </iidm:extension>
+</iidm:network>
diff --git a/test/resources/V1_5/staticVarCompensatorRoundTripRef.xml b/test/resources/V1_5/staticVarCompensatorRoundTripRef.xml
new file mode 100644
index 00000000..7210b122
--- /dev/null
+++ b/test/resources/V1_5/staticVarCompensatorRoundTripRef.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="svcTestCase" caseDate="2016-06-29T14:54:03.427000+02:00" forecastDistance="0" sourceFormat="code">
+    <iidm:substation id="S1" country="FR">
+        <iidm:voltageLevel id="VL1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B1"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="G1" energySource="OTHER" minP="50" maxP="150" voltageRegulatorOn="true" targetP="100" targetV="400" bus="B1" connectableBus="B1">
+                <iidm:minMaxReactiveLimits minQ="-1.7976931348623157e+308" maxQ="1.7976931348623157e+308"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:substation id="S2" country="FR">
+        <iidm:voltageLevel id="VL2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="B2"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="L2" loadType="UNDEFINED" p0="100" q0="50" bus="B2" connectableBus="B2"/>
+            <iidm:staticVarCompensator id="SVC2" bMin="0.00020000000000000001" bMax="0.00080000000000000004" voltageSetpoint="390" regulationMode="VOLTAGE" bus="B2" connectableBus="B2">
+                <iidm:property name="test" value="test"/>
+            </iidm:staticVarCompensator>
+        </iidm:voltageLevel>
+    </iidm:substation>
+    <iidm:line id="L1" r="4" x="200" g1="0" b1="0" g2="0" b2="0" bus1="B1" connectableBus1="B1" voltageLevelId1="VL1" bus2="B2" connectableBus2="B2" voltageLevelId2="VL2"/>
+</iidm:network>
diff --git a/test/resources/V1_5/terminalRef.xml b/test/resources/V1_5/terminalRef.xml
new file mode 100644
index 00000000..d3e067e9
--- /dev/null
+++ b/test/resources/V1_5/terminalRef.xml
@@ -0,0 +1,56 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="terminalRef" caseDate="2014-11-08T19:00:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="S1" country="FR" tso="RTE">
+        <iidm:voltageLevel id="VL4" nominalV="90" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="VL41" v="91.126113899999993" angle="-11.178720500000001"/>
+            </iidm:busBreakerTopology>
+            <iidm:shunt id="SHUNT_VL4.11" sectionCount="1" voltageRegulatorOn="false" connectableBus="VL41" q="9999">
+                <iidm:shuntLinearModel bPerSection="0.0035802468191832304" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:shunt id="SHUNT_VL4.21" sectionCount="1" voltageRegulatorOn="false" connectableBus="VL41" q="9999">
+                <iidm:shuntLinearModel bPerSection="0.0037037036381661892" maximumSectionCount="1"/>
+            </iidm:shunt>
+            <iidm:shunt id="SHUNT_VL4.31" sectionCount="1" voltageRegulatorOn="false" connectableBus="VL41" q="9999">
+                <iidm:shuntLinearModel bPerSection="0.0037037036381661892" maximumSectionCount="1"/>
+            </iidm:shunt>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL6" nominalV="225" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="VL61" v="237.97369399999999" angle="-9.0618209800000002"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="100" targetV="225" targetQ="0" bus="VL61" connectableBus="VL61">
+                <iidm:regulatingTerminal id="SHUNT_VL4.31"/>
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="VLY641" r="1.549974799156189" x="58.800025939941406" g="0" b="0" ratedU1="90" ratedU2="225" bus1="VL41" connectableBus1="VL41" voltageLevelId1="VL4" bus2="VL61" connectableBus2="VL61" voltageLevelId2="VL6" p1="-35.508800506591797" q1="-0.79081434011459351" p2="35.543498992919922" q2="2.1071410179138184">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" loadTapChangingCapabilities="true" regulating="false" targetV="91.128028869628906">
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.01900005"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0080000200000001"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.995999992"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+        <iidm:twoWindingsTransformer id="VL642" r="1.8199917078018188" x="62.600349426269531" g="0" b="0" ratedU1="90" ratedU2="225" bus1="VL41" connectableBus1="VL41" voltageLevelId1="VL4" bus2="VL61" connectableBus2="VL61" voltageLevelId2="VL6" p1="-33.338603973388672" q1="-2.3741626739501953" p2="33.374824523925781" q2="3.6199276447296143">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" loadTapChangingCapabilities="true" regulating="false" targetV="91.128028869628906">
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0160000300000001"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0039999500000001"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.991999984"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+        <iidm:twoWindingsTransformer id="VLY643" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="VL41" connectableBus1="VL41" voltageLevelId1="VL4" bus2="VL61" connectableBus2="VL61" voltageLevelId2="VL6">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="1" regulationMode="FIXED_TAP" regulationValue="200">
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913" alpha="-1"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666" alpha="0"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141" alpha="1"/>
+            </iidm:phaseTapChanger>
+        </iidm:twoWindingsTransformer>
+        <iidm:twoWindingsTransformer id="VLY644" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="VL41" connectableBus1="VL41" voltageLevelId1="VL4" bus2="VL61" connectableBus2="VL61" voltageLevelId2="VL6">
+            <iidm:phaseTapChanger lowTapPosition="0" tapPosition="1" regulationMode="FIXED_TAP" regulationValue="200">
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913" alpha="-1"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666" alpha="0"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141" alpha="1"/>
+            </iidm:phaseTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/threeWindingsTransformerRoundTripRef.xml b/test/resources/V1_5/threeWindingsTransformerRoundTripRef.xml
new file mode 100644
index 00000000..1cd3dd77
--- /dev/null
+++ b/test/resources/V1_5/threeWindingsTransformerRoundTripRef.xml
@@ -0,0 +1,49 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="three-windings-transformer" caseDate="2018-03-05T13:30:30.486000+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="SUBSTATION" country="FR">
+        <iidm:voltageLevel id="VL_132" nominalV="132" lowVoltageLimit="118.8" highVoltageLimit="145.19999999999999" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_132" v="133.584" angle="-9.6199999999999992"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_132" loadType="UNDEFINED" p0="7.5999999999999996" q0="1.6000000000000001" bus="BUS_132" connectableBus="BUS_132"/>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL_33" nominalV="33" lowVoltageLimit="29.699999999999999" highVoltageLimit="36.299999999999997" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_33" v="34.881" angle="-15.24"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_33" loadType="UNDEFINED" p0="11.199999999999999" q0="7.5" bus="BUS_33" connectableBus="BUS_33" p="11.199999999999999" q="7.5"/>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VL_11" nominalV="11" lowVoltageLimit="9.9000000000000004" highVoltageLimit="12.1" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="BUS_11" v="11.781000000000001" angle="-15.24"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD_11" loadType="UNDEFINED" p0="0" q0="-10.6" bus="BUS_11" connectableBus="BUS_11" p="0" q="-10.6"/>
+        </iidm:voltageLevel>
+        <iidm:threeWindingsTransformer id="3WT" r1="17.423999999999999" x1="1.7423999999999999" g1="0.0057392102846648297" b1="0.00057392102846648299" ratedU1="132" r2="1.089" x2="0.1089" g2="0" b2="0" ratedU2="33" r3="0.121" x3="0.0121" g3="0" b3="0" ratedU3="11" ratedU0="132" bus1="BUS_132" connectableBus1="BUS_132" voltageLevelId1="VL_132" bus2="BUS_33" connectableBus2="BUS_33" voltageLevelId2="VL_33" bus3="BUS_11" connectableBus3="BUS_11" voltageLevelId3="VL_11">
+            <iidm:ratioTapChanger2 lowTapPosition="0" tapPosition="2" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="33">
+                <iidm:terminalRef id="LOAD_33"/>
+                <iidm:step r="0.98009999999999997" x="0.09801" g="0.082644628099173556" b="0.0082644628099173556" rho="0.90000000000000002"/>
+                <iidm:step r="1.089" x="0.1089" g="0.091827364554637275" b="0.0091827364554637279" rho="1"/>
+                <iidm:step r="1.1979" x="0.11978999999999999" g="0.10101010101010101" b="0.0101010101010101" rho="1.1000000000000001"/>
+            </iidm:ratioTapChanger2>
+            <iidm:ratioTapChanger3 lowTapPosition="0" tapPosition="0" targetDeadband="0" loadTapChangingCapabilities="true" regulating="false" targetV="11">
+                <iidm:terminalRef id="LOAD_11"/>
+                <iidm:step r="0.1089" x="0.01089" g="0.82644628099173556" b="0.082644628099173556" rho="0.90000000000000002"/>
+                <iidm:step r="0.121" x="0.0121" g="0.82644628099173556" b="0.082644628099173556" rho="1"/>
+                <iidm:step r="0.1331" x="0.013310000000000001" g="0.90909090909090917" b="0.090909090909090925" rho="1.1000000000000001"/>
+            </iidm:ratioTapChanger3>
+            <iidm:currentLimits1 permanentLimit="1000">
+                <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="1200"/>
+                <iidm:temporaryLimit name="10'" acceptableDuration="600" value="1400"/>
+            </iidm:currentLimits1>
+            <iidm:currentLimits2 permanentLimit="100">
+                <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="120"/>
+                <iidm:temporaryLimit name="10'" acceptableDuration="600" value="140"/>
+            </iidm:currentLimits2>
+            <iidm:currentLimits3 permanentLimit="10">
+                <iidm:temporaryLimit name="20'" acceptableDuration="1200" value="12"/>
+                <iidm:temporaryLimit name="10'" acceptableDuration="600" value="14"/>
+            </iidm:currentLimits3>
+        </iidm:threeWindingsTransformer>
+    </iidm:substation>
+</iidm:network>
diff --git a/test/resources/V1_5/tieline.xml b/test/resources/V1_5/tieline.xml
new file mode 100644
index 00000000..62a9df5d
--- /dev/null
+++ b/test/resources/V1_5/tieline.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN" v="24.500000610351563" angle="2.3259763717651367"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN" p="-605.558349609375" q="-225.28251647949219">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1" v="402.14284515380859" angle="0"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1" p1="605.558349609375" q1="225.28251647949219" p2="-604.89093017578125" q2="-197.48046875"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2" v="389.95267639160159" angle="-3.5063576698303223"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD" v="147.57861328125" angle="-9.6144866943359375"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD" p="600" q="200"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD" p1="600.8677978515625" q1="274.37698364257" p2="-600" q2="-200">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:tieLine id="NHV1_NHV2_1" ucteXnodeCode="X1" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906" id_1="NHV1_NHV2_1.1" r_1="1.5" x_1="16.5" g1_1="0" b1_1="9.6500000000000001e-05" g2_1="0" b2_1="9.6500000000000001e-05" xnodeP_1="302.44406127929688" xnodeQ_1="98.740272521972656" id_2="NHV1_NHV2_1.2" r_2="1.5" x_2="16.5" g1_2="0" b1_2="9.6500000000000001e-05" g2_2="0" b2_2="9.6500000000000001e-05" xnodeP_2="-300.43389892578125" xnodeQ_2="-137.18849182128906"/>
+    <iidm:tieLine id="NHV1_NHV2_2" ucteXnodeCode="X2" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906" id_1="NHV1_NHV2_2.1" r_1="1.5" x_1="16.5" g1_1="0" b1_1="9.6500000000000001e-05" g2_1="0" b2_1="9.6500000000000001e-05" xnodeP_1="302.44406127929688" xnodeQ_1="98.740272521972656" id_2="NHV1_NHV2_2.2" r_2="1.5" x_2="16.5" g1_2="0" b1_2="9.6500000000000001e-05" g2_2="0" b2_2="9.6500000000000001e-05" xnodeP_2="-300.43389892578125" xnodeQ_2="-137.18849182128906"/>
+</iidm:network>
diff --git a/test/resources/V1_5/tielineFictitious.xml b/test/resources/V1_5/tielineFictitious.xml
new file mode 100644
index 00000000..f2ff45e5
--- /dev/null
+++ b/test/resources/V1_5/tielineFictitious.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN" v="24.500000610351563" angle="2.3259763717651367"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN" p="-605.558349609375" q="-225.28251647949219">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1" v="402.14284515380859" angle="0"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1" p1="605.558349609375" q1="225.28251647949219" p2="-604.89093017578125" q2="-197.48046875"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2" v="389.95267639160159" angle="-3.5063576698303223"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD" v="147.57861328125" angle="-9.6144866943359375"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD" p="600" q="200"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD" p1="600.8677978515625" q1="274.37698364257" p2="-600" q2="-200">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:tieLine id="NHV1_NHV2_1" ucteXnodeCode="X1" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906" id_1="NHV1_NHV2_1.1" r_1="1.5" x_1="16.5" g1_1="0" b1_1="9.6500000000000001e-05" g2_1="0" b2_1="9.6500000000000001e-05" xnodeP_1="302.44406127929688" xnodeQ_1="98.740272521972656" fictitious_1="true" id_2="NHV1_NHV2_1.2" r_2="1.5" x_2="16.5" g1_2="0" b1_2="9.6500000000000001e-05" g2_2="0" b2_2="9.6500000000000001e-05" xnodeP_2="-300.43389892578125" xnodeQ_2="-137.18849182128906"/>
+    <iidm:tieLine id="NHV1_NHV2_2" ucteXnodeCode="X2" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906" id_1="NHV1_NHV2_2.1" r_1="1.5" x_1="16.5" g1_1="0" b1_1="9.6500000000000001e-05" g2_1="0" b2_1="9.6500000000000001e-05" xnodeP_1="302.44406127929688" xnodeQ_1="98.740272521972656" id_2="NHV1_NHV2_2.2" r_2="1.5" x_2="16.5" g1_2="0" b1_2="9.6500000000000001e-05" g2_2="0" b2_2="9.6500000000000001e-05" xnodeP_2="-300.43389892578125" xnodeQ_2="-137.18849182128906" fictitious_2="true"/>
+</iidm:network>
diff --git a/test/resources/V1_5/tielineWithAliases.xml b/test/resources/V1_5/tielineWithAliases.xml
new file mode 100644
index 00000000..838bcf72
--- /dev/null
+++ b/test/resources/V1_5/tielineWithAliases.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<iidm:network xmlns:iidm="http://www.powsybl.org/schema/iidm/1_5" id="sim1" caseDate="2013-01-15T18:45:00+01:00" forecastDistance="0" sourceFormat="test">
+    <iidm:substation id="P1" country="FR" tso="RTE" geographicalTags="A">
+        <iidm:voltageLevel id="VLGEN" nominalV="24" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NGEN" v="24.500000610351563" angle="2.3259763717651367"/>
+            </iidm:busBreakerTopology>
+            <iidm:generator id="GEN" energySource="OTHER" minP="-9999.9899999999998" maxP="9999.9899999999998" voltageRegulatorOn="true" targetP="607" targetV="24.5" targetQ="301" bus="NGEN" connectableBus="NGEN" p="-605.558349609375" q="-225.28251647949219">
+                <iidm:minMaxReactiveLimits minQ="-9999.9899999999998" maxQ="9999.9899999999998"/>
+            </iidm:generator>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLHV1" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV1" v="402.14284515380859" angle="0"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NGEN_NHV1" r="0.26658461538461536" x="11.104492831516762" g="0" b="0" ratedU1="24" ratedU2="400" bus1="NGEN" connectableBus1="NGEN" voltageLevelId1="VLGEN" bus2="NHV1" connectableBus2="NHV1" voltageLevelId2="VLHV1" p1="605.558349609375" q1="225.28251647949219" p2="-604.89093017578125" q2="-197.48046875"/>
+    </iidm:substation>
+    <iidm:substation id="P2" country="FR" tso="RTE" geographicalTags="B">
+        <iidm:voltageLevel id="VLHV2" nominalV="380" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NHV2" v="389.95267639160159" angle="-3.5063576698303223"/>
+            </iidm:busBreakerTopology>
+        </iidm:voltageLevel>
+        <iidm:voltageLevel id="VLLOAD" nominalV="150" topologyKind="BUS_BREAKER">
+            <iidm:busBreakerTopology>
+                <iidm:bus id="NLOAD" v="147.57861328125" angle="-9.6144866943359375"/>
+            </iidm:busBreakerTopology>
+            <iidm:load id="LOAD" loadType="UNDEFINED" p0="600" q0="200" bus="NLOAD" connectableBus="NLOAD" p="600" q="200"/>
+        </iidm:voltageLevel>
+        <iidm:twoWindingsTransformer id="NHV2_NLOAD" r="0.047249999999999993" x="4.0497243656204551" g="0" b="0" ratedU1="400" ratedU2="158" bus1="NHV2" connectableBus1="NHV2" voltageLevelId1="VLHV2" bus2="NLOAD" connectableBus2="NLOAD" voltageLevelId2="VLLOAD" p1="600.8677978515625" q1="274.37698364257" p2="-600" q2="-200">
+            <iidm:ratioTapChanger lowTapPosition="0" tapPosition="1" targetDeadband="0" loadTapChangingCapabilities="true" regulating="true" targetV="158">
+                <iidm:terminalRef id="NHV2_NLOAD" side="TWO"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="0.85056669052441913"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.0006666666666666"/>
+                <iidm:step r="0" x="0" g="0" b="0" rho="1.1507666428089141"/>
+            </iidm:ratioTapChanger>
+        </iidm:twoWindingsTransformer>
+    </iidm:substation>
+    <iidm:tieLine id="NHV1_NHV2_1" ucteXnodeCode="X1" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906" id_1="NHV1_NHV2_1.1" r_1="1.5" x_1="16.5" g1_1="0" b1_1="9.6500000000000001e-05" g2_1="0" b2_1="9.6500000000000001e-05" xnodeP_1="302.44406127929688" xnodeQ_1="98.740272521972656" id_2="NHV1_NHV2_1.2" r_2="1.5" x_2="16.5" g1_2="0" b1_2="9.6500000000000001e-05" g2_2="0" b2_2="9.6500000000000001e-05" xnodeP_2="-300.43389892578125" xnodeQ_2="-137.18849182128906">
+        <iidm:alias>Alias</iidm:alias>
+        <iidm:alias>Other alias</iidm:alias>
+    </iidm:tieLine>
+    <iidm:tieLine id="NHV1_NHV2_2" ucteXnodeCode="X2" bus1="NHV1" connectableBus1="NHV1" voltageLevelId1="VLHV1" bus2="NHV2" connectableBus2="NHV2" voltageLevelId2="VLHV2" p1="302.44406127929688" q1="98.740272521972656" p2="-300.43389892578125" q2="-137.18849182128906" id_1="NHV1_NHV2_2.1" r_1="1.5" x_1="16.5" g1_1="0" b1_1="9.6500000000000001e-05" g2_1="0" b2_1="9.6500000000000001e-05" xnodeP_1="302.44406127929688" xnodeQ_1="98.740272521972656" id_2="NHV1_NHV2_2.2" r_2="1.5" x_2="16.5" g1_2="0" b1_2="9.6500000000000001e-05" g2_2="0" b2_2="9.6500000000000001e-05" xnodeP_2="-300.43389892578125" xnodeQ_2="-137.18849182128906"/>
+</iidm:network>
